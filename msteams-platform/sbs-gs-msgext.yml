### YamlMime:Tutorial
title: 使用 JavaScript 生成第一个消息传递扩展应用
metadata:
  title: 使用 JavaScript Hello World
  description: 本教程介绍如何通过 Teams 工具包设置新项目、生成和部署消息扩展应用，从而使用 JavaScript 生成 Hello World 应用。
  audience: Developer
  level: Beginner
  ms.date: 05/26/2022
  ms.topic: interactive-tutorial
  nextTutorialHref: ~/get-started/get-started-overview.md
  nextTutorialTitle: 返回到入门概述
  ms.custom: mvc
  ms.localizationpriority: high
  ms.openlocfilehash: e9157fd4f0603652f9d8f2d1dc5910024c96d6db
  ms.sourcegitcommit: 0e4fcbc5efff4bfa1dbfba1e5467bbfaa6638705
  ms.translationtype: MT
  ms.contentlocale: zh-CN
  ms.lasthandoff: 10/28/2022
  ms.locfileid: "68773534"
items:
- durationInMinutes: 1
  content: "使用第一个 Teams 应用开始 Microsoft Teams 应用开发。 你将创建消息扩展 Teams 应用。 \n\n你的应用将具有一个功能，该功能附带其自己的 UI 和 UX：\n\n:::image type=\"content\" source=\"~/assets/images/teams-toolkit-v2/prerequisites/your-helloworld-app.png\" alt-text=\"显示此应用的示意图有三个功能。\":::\n\n\n在本教程中，你将了解：\n\n- 如何使用 Teams 工具包设置新项目。\n- 如何生成消息扩展应用。\n- 如何部署应用。\n"
- title: 先决条件
  durationInMinutes: 1
  content: "\n下面是生成和部署应用所需的工具列表。\n\n| &nbsp; | 安装 | 用于使用... |\n| --- | --- | --- |\n| **Required** | &nbsp; | &nbsp; |\n| &nbsp; | [Visual Studio Code](https://code.visualstudio.com/download) | JavaScript 或 TypeScript，生成环境。 使用最新版本。 |\n| &nbsp; | [Teams 工具包](#install-the-teams-toolkit) | Microsoft Visual Studio Code扩展，用于为应用创建项目基架。 使用版本 4.0.0。|\n| &nbsp; | [Node.js](https://nodejs.org/en/download/) | 后端 JavaScript 运行时环境。 使用版本 14 或 16。|\n| &nbsp; | [Microsoft Teams](https://www.microsoft.com/microsoft-teams/download-app) | Microsoft Teams 可在一个位置通过聊天、会议、通话等应用与你合作的每个人进行协作。|\n| &nbsp; | [微软&nbsp;Edge (建议](https://www.microsoft.com/edge)) 或 [Google Chrome](https://www.google.com/chrome/) | 包含开发人员工具的浏览器。 |\n| &nbsp; | [Microsoft 365 开发人员帐户](/microsoftteams/platform/concepts/build-and-test/prepare-your-o365-tenant) | 具有安装应用的相应权限的 Teams 帐户的访问权限。 |\n| **可选** | &nbsp; | &nbsp; |\n| &nbsp; | [Azure Tools for Visual Studio Code](https://marketplace.visualstudio.com/items?itemName=ms-vscode.vscode-node-azure-pack) 和 [Azure CLI](/cli/azure/install-azure-cli) | 用于访问存储的数据或在 Azure 中为 Teams 应用部署基于云的后端的 Azure 工具。 |\n| &nbsp; | [React Chrome 开发人员工具](https://chrome.google.com/webstore/detail/react-developer-tools/fmkadmapgofadopljbjfkapdkoienihi)或 [microsoft Edge React开发人员工具&nbsp;](https://microsoftedge.microsoft.com/addons/detail/react-developer-tools/gpphkfbcpidddadnkolkpfckpihlkkil) | 开放源代码React JavaScript 库的浏览器 DevTools 扩展。 |\n| &nbsp; | [Microsoft Graph 浏览器](https://developer.microsoft.com/graph/graph-explorer) | Microsoft Graph 资源管理器是一种基于浏览器的工具，可用于从 Microsoft Graph 数据运行查询。 |\n| &nbsp; | [Teams 开发人员门户](https://dev.teams.microsoft.com/) | 基于 Web 的门户，用于配置、管理和分发 Teams 应用，包括组织或 Teams 应用商店。 |\n\n\n> [!TIP]\n> 如果使用 Microsoft Graph 数据，则应了解 Microsoft Graph 资源管理器并添加书签。 使用此基于浏览器的工具可以在应用外部查询 Microsoft Graph。\n\n\n## <a name=\"prepare-development-environment\"></a>准备开发环境\n\n安装所需的工具后，设置开发环境。\n\n\n### <a name=\"install-the-teams-toolkit\"></a>安装 Teams 工具包\n\nTeams 工具包通过为应用预配和部署云资源、发布到 Teams 应用商店等工具来帮助简化开发过程。 \n \n可以将工具包与 Visual Studio Code 或 CLI (命令行接口) 配合使用，称为 `TeamsFx`。\n\n\n# <a name=\"visual-studio-code\"></a>[Visual Studio Code](#tab/vscode)\n\n1. 打开Visual Studio Code并选择“**扩展”** 视图， (**Ctrl+Shift+X** / **⌘⇧-X** 或 **“查看>扩展**”) 。\n1. 在搜索框中，输入 **Teams 工具包**。\n1. 选择 Teams 工具包旁边的 **“安装** ”。\n\n :::image type=\"content\" source=\"~/assets/images/teams-toolkit-v2/prerequisites/install-toolkit-vscodeversion.png\" alt-text=\"图中显示了 Teams 工具包扩展安装。\":::\n\n 安装后，Teams 工具包图标将显示在Visual Studio Code边栏中。\n\n :::image type=\"content\" source=\"~/assets/images/teams-toolkit-v2/prerequisites/hw-teams-toolkit-sidebar-icon.png\" alt-text=\"图中显示了Visual Studio Code边栏中的 Teams 工具包图标。\":::\n\n还可以在[Visual Studio Code市场](https://marketplace.visualstudio.com/items?itemName=TeamsDevApp.ms-teams-vscode-extension)中找到 Teams 工具包。\n\n# <a name=\"command-line\"></a>[命令行](#tab/cli)\n\n若要安装 TeamsFx CLI，请使用 `npm` 包管理器：\n\n``` bash\nnpm install -g @microsoft/teamsfx-cli\n```\n\n根据配置，可能需要使用 `sudo` 来安装 CLI：\n\n``` bash\nsudo npm install -g --unsafe-perm @microsoft/teamsfx-cli\n```\n\n这种情况在 Linux 和 macOS 系统上更为常见。\n\n确保将 npm 全局缓存添加到 PATH。 此步骤通常作为Node.js安装程序的一部分完成。  \n\n可以将 CLI 与 命令一起使用 `teamsfx` 。 通过运行 `teamsfx -h`验证命令是否正常工作。\n\n> [!CAUTION]\n> 在 PowerShell 终端中运行 TeamsFx 之前，必须为 PowerShell 启用“远程签名”执行策略。\n\n---\n\n## <a name=\"set-up-your-teams-development-tenant\"></a>设置 Teams 开发租户\n\n**租户** 类似于 Teams 中组织的空间或容器，可在其中聊天、共享文件和运行会议。 此空间也是旁加载和测试应用的位置。 让我们验证是否已准备好使用租户进行开发。\n\n### <a name=\"check-for-sideloading-option\"></a>检查旁加载选项\n\n创建应用后，必须在 Teams 中加载应用，而无需分发它。 此过程称为“旁加载”。 登录到 Microsoft 365 帐户以查看此选项。\n\n > [!NOTE]\n > 在 Teams 本地环境中预览和测试应用时，需要旁加载。 如果未启用，将无法在本地 Teams 中预览和测试应用。\n\n是否已拥有租户，并且是否具有管理员访问权限？ 让我们来看看你是否真的这样做了！\n\n验证是否可以在 Teams 中旁加载应用：\n\n 1. 在 Teams 客户端中，选择“ **应用商店** ”图标。\n 1. 选择“**管理应用**”。\n 1. 选择“**发布应用**”。\n 1. 查找“ **上传自定义应用**”选项。 如果看到 选项，则表示已启用旁加载应用。\n\n     :::image type=\"content\" source=\"~/assets/images/teams-toolkit-v2/spfx-custom-new1.png\" alt-text=\"机器人主页\":::\n\n     > [!NOTE]\n     > 如果没有上传自定义应用的选项，请与 Teams 管理员联系。\n\n### <a name=\"create-a-free-teams-developer-tenant-optional\"></a>创建免费的 Teams 开发人员租户 (可选) \n\n如果没有 Teams 开发人员帐户，可以免费获取它。 加入 Microsoft 365 开发人员计划！\n\n1. 转到 [Microsoft 365 开发人员计划](https://developer.microsoft.com/microsoft-365/dev-program)。\n1. 选择“ **立即加入** ”，然后按照屏幕上的说明进行操作。\n1. 在欢迎屏幕中，选择“ **设置 E5 订阅**”。\n1. 设置管理员帐户。 完成后，将显示以下屏幕。\n\n    :::image type=\"content\" source=\"~/assets/images/teams-toolkit-v2/prerequisites/microsoft-365.png\" alt-text=\"Microsoft\":::\n\n1. 使用刚刚设置的管理员帐户登录到 Teams。 验证在 Teams 中是否具有 **“上传自定义应用** ”选项。\n\n## <a name=\"get-a-free-azure-account\"></a>获取免费的 Azure 帐户\n\n如果要在 Azure 中托管应用或访问资源，则必须拥有 Azure 订阅。 在开始之前[创建一个免费帐户](https://azure.microsoft.com/free/)。\n\n现在，你已获得所有工具并设置帐户。 接下来，让我们设置开发环境并开始生成！ 选择要首先执行的应用。\n"
- title: 为消息扩展应用创建项目工作区
  durationInMinutes: 1
  content: "\n你已生成机器人应用。 现在，让我们创建第一个消息扩展应用。\n\n消息扩展功能允许你与 Web 服务交互。 使用 Teams 客户端中的撰写区域、命令框或消息传递在外部系统中搜索和启动操作。\n\n  :::image type=\"content\" source=\"~/assets/images/teams-toolkit-v2/first-msgext/your-helloworld-app-msgext.png\" alt-text=\"显示此应用的示意图有三个功能。突出显示了消息扩展。\":::\n\n有两种类型的 Teams **消息扩展**：\n\n- [搜索命令](../msteams-platform/messaging-extensions/how-to/search-commands/define-search-command.md)：可以搜索外部系统。 然后，可以将其结果插入到卡片形式的消息中。\n- [操作命令](../msteams-platform/messaging-extensions/how-to/action-commands/define-action-command.md)：可以使用模式弹出窗口向用户显示以收集或显示信息。 然后，可以处理他们的交互，并将信息发送回 Teams。\n\n让我们使用 *搜索命令* 创建消息扩展应用。 使用它搜索外部数据并将结果插入 Teams 客户端中的邮件中。\n\n由于已准备好创建这些应用，因此可以设置用于创建消息扩展应用的新 Teams 项目。\n\n> [!NOTE]\n> 消息扩展依赖于机器人在用户和代码之间提供对话。\n\n\n在本教程中，你将了解：\n\n1. [如何使用 Teams 工具包设置新的消息扩展项目。](#create-your-message-extension-project-workspace)\n1. [关于应用项目的目录结构。](#take-a-tour-of-the-message-extension-app-source-code)\n\n## <a name=\"create-your-message-extension-project-workspace\"></a>创建消息扩展项目工作区\n\n如果先决条件已到位，让我们开始吧！\n\n> [!NOTE]\n> 显示的Visual Studio Code UI 来自 Mac。 它可能因操作系统、工具包版本和环境而异。\n\n# <a name=\"visual-studio-code\"></a>[Visual Studio Code](#tab/vsc)\n\n1. 打开 Visual Studio Code。\n1. 在 Visual Studio Code 边栏中选择 Teams 工具包 :::image type=\"icon\" source=\"../msteams-platform/assets/images/teams-toolkit-v2/teams-toolkit-sidebar-icon.png\"::: 图标。\n\n1. 选择 **创建新的 Teams 应用**。\n\n    :::image type=\"content\" source=\"../msteams-platform/assets/images/teams-toolkit-v2/first-msgext/create-project.png\" alt-text=\"Teams 工具包边栏中&quot;创建新项目&quot;链接的位置。\":::\n\n1. 选择“ **创建新的 Teams 应用** ”以使用 Teams 工具包创建应用。\n\n    :::image type=\"content\" source=\"../msteams-platform/assets/images/teams-toolkit-v2/first-msgext/create-new-app1.png\" alt-text=\"&quot;创建新项目&quot;的向导启动\":::\n\n1. 确保已选择 **“消息扩展** ”作为要在应用中生成的功能。\n\n    :::image type=\"content\" source=\"../msteams-platform/assets/images/teams-toolkit-v2/first-msgext/select-capabilities-mex1.png\" alt-text=\"显示如何向新应用添加功能的屏幕截图。\":::\n\n1. 选择 **JavaScript** 作为编程语言。\n\n    :::image type=\"content\" source=\"../msteams-platform/assets/images/teams-toolkit-v2/first-msgext/select-language-tab.png\" alt-text=\"显示如何选择编程语言的屏幕截图。\":::\n\n1. 选择“ **默认文件夹** ”，将项目根文件夹存储在默认位置。\n\n    :::image type=\"content\" source=\"../msteams-platform/assets/images/teams-toolkit-v2/first-msgext/select-default-location.png\" alt-text=\"选择默认位置\":::\n\n    还可以通过以下步骤更改默认位置：\n\n    1. 选择“ **浏览**”。\n\n        :::image type=\"content\" source=\"../msteams-platform/assets/images/teams-toolkit-v2/first-msgext/select-browse.png\" alt-text=\"选择浏览位置\":::\n        \n    1. 选择项目工作区的位置。\n\n    1. 选择 **“选择文件夹**”。\n\n        :::image type=\"content\" source=\"../msteams-platform/assets/images/teams-toolkit-v2/select-folder.png\" alt-text=\"显示如何选择文件夹的屏幕截图。\":::\n\n1. 为应用输入合适的名称。 确保应用的名称是字母数字。 选择“**Enter**”。\n\n    :::image type=\"content\" source=\"../msteams-platform/assets/images/teams-toolkit-v2/first-msgext/enter-project-name.png\" alt-text=\"显示如何输入应用名称的屏幕截图。\":::\n\n1. 默认情况下，项目将在 10 秒内以新窗口打开。 如果要在当前窗口中打开，请选择“ **在当前窗口中打开**”。\n\n     :::image type=\"content\" source=\"../msteams-platform/assets/images/teams-toolkit-v2/first-msgext/new-window-notification.png\" alt-text=\"新建窗口通知。\":::\n\n    Teams 工具包会在几秒钟内创建应用。\n\n    :::image type=\"content\" source=\"../msteams-platform/assets/images/teams-toolkit-v2/first-msgext/app-created-mex.png\" alt-text=\"显示已创建的应用的屏幕截图。\":::\n\n    创建应用后，Teams 工具包会显示以下消息： \n\n    :::image type=\"content\" source=\"../msteams-platform/assets/images/teams-toolkit-v2/preview-project.png\" alt-text=\"Localdebug\":::\n\n    可以选择“ **本地调试** ”以预览项目。 \n\n  <details>\n  <summary>快速回顾如何创建 Teams 应用。</summary>\n  观看此简短回顾，了解如何创建 Teams 应用。\n\n  ![创建 Teams 应用](~/assets/videos/javascript-msg-ext-app1.gif)\n  </details>\n\n# <a name=\"command-line\"></a>[命令行](#tab/cli)\n\n使用 `teamsfx` CLI 创建你的第一个项目。 从要创建项目文件夹的文件夹开始。\n\n``` bash\nteamsfx new\n```\n\n可以使用 CLI 创建新的 Teams 应用。 CLI 将引导你完成一系列问题。 每个问题都包含一个关于回答它的指令。\n\n例如，使用箭头键选择一个选项。 做出选择后 **，选择 Enter** 进行确认。\n\n\n1. 选择 **创建新的 Teams 应用**。\n1. 选择“ **邮件扩展** ”并取消选择 **“选项卡**”。\n1. 选择 **JavaScript** 作为编程语言。\n1. 选择 **Enter** 以选择默认工作区文件夹。\n1. 为应用输入合适的名称，如 `HelloMsgExtn`。  应用的名称只能包含字母数字字符。\n\n  回答所有问题后，将创建项目。\n\n---\n\n## <a name=\"take-a-tour-of-the-message-extension-app-source-code\"></a>浏览消息扩展应用源代码\n\n消息扩展使用 Bot Framework。 使用它通过对话与服务交互。 基架完成后，在 Visual Studio Code 的“资源管理器”区域中查看项目目录和文件。\n\n:::image type=\"content\" source=\"~/assets/images/teams-toolkit-v2/first-msgext/folder-structure-mex-app.png\" alt-text=\"folder msg\":::\n\n| 文件夹名 | 目录 |\n| --- | --- |\n| `.fx/configs` | 用户可以为 Teams 应用自定义的配置文件。 |\n| `.fx/configs/config.<envName>.json` | 每个环境的配置文件。 |\n| `.fx/configs/azure.parameters.<envName>.json` | 用于为每个环境预配 Azure BICEP 的参数文件。 |\n| `.fx/configs/projectSettings.json` | 应用于所有环境的全局项目设置。 |\n| `.fx/configs/ngrok.yml` | Ngrok 设置 |\n| `.fx/states` | 预配工具包生成的输出。  为应用预配资源后，工具包会创建此文件夹。 |\n| `.fx/states/state.<envName>.json` | 为每个环境预配输出文件。 |\n| `.fx/states/<env>.userdata` | 每个环境的预配输出的敏感用户数据。 |\n| `bot` |  运行时所需的机器人代码。 |\n| `bot/messageExtensionBot.js` | 消息扩展应用的主入口点。 |\n| `templates/appPackage` | 应用清单模板文件和应用图标color.png和outline.png。 |\n| `templates/appPackage/manifest.template.json` | 用于在本地和远程环境中运行应用的应用清单。  |\n| `templates/azure` | BICEP 模板文件 |\n\n> [!Tip]\n> 在 Teams 中集成应用之前，请先熟悉 Teams 外部的机器人和消息扩展。\n"
- title: 生成并运行第一个消息扩展应用
  durationInMinutes: 1
  content: "\n使用 Teams 工具包设置项目工作区后，生成项目。 需要登录到 Microsoft 365 帐户。\n\n## <a name=\"sign-in-to-your-microsoft-365-account\"></a>登录到 Microsoft 365 帐户\n\n使用此帐户登录到 Teams。 如果你使用的是 Microsoft 365 开发人员计划租户，则注册时设置的管理员帐户是你的 Microsoft 365 帐户。\n\n# <a name=\"visual-studio-code\"></a>[Visual Studio Code](#tab/vcode)\n\n1. 打开 Visual Studio 代码。\n1. 选择边栏中的“Teams 工具包”  :::image type=\"icon\" source=\"../msteams-platform/assets/images/teams-toolkit-v2/teams-toolkit-sidebar-icon.png\"::: 图标。\n1. 选择“ **登录到 M365**”。\n\n    此时会打开默认 Web 浏览器，以便登录帐户。\n\n1. 登录到 Microsoft 365 帐户。\n1. 出现提示时关闭浏览器并返回到Visual Studio Code。\n1. 返回到 Visual Studio Code 内的 Teams 工具包。\n\n    边栏的 **“帐户** ”部分显示你的 Microsoft 365 帐户名称。 如果为 Microsoft 365 帐户 **启用了旁加载** ，则 Teams 工具包将显示“已启用旁加载”。\n\n    :::image type=\"content\" source=\"../msteams-platform/assets/images/teams-toolkit-v2/first-tab/m365-sideloading-enabled-msg.png\" alt-text=\"显示登录 Microsoft 365 和 Azure 的位置的屏幕截图。\":::\n\n    现在，你已准备好生成应用并在本地运行它！\n\n# <a name=\"command-line\"></a>[命令行](#tab/cline)\n\n1. 使用 TeamsFx CLI 登录到 Microsoft 365：\n\n    ``` bash\n    teamsfx account login m365\n    ```\n\n    此时会打开默认 Web 浏览器，以便登录帐户。 使用凭据登录到 Azure 帐户。 出现提示时关闭浏览器。\n\n2. 使用 TeamsFx CLI 登录到 Azure：\n\n    ``` bash\n    teamsfx account login azure\n    ```\n\n    此时会打开默认 Web 浏览器，以便登录帐户。 使用凭据登录到 Azure 帐户。 出现提示时关闭浏览器。\n\n    帐户登录名在 Visual Studio Code 和 TeamsFx CLI 之间共享。\n\n    配置开发环境后，可以创建、生成和部署第一个 Teams 应用。\n\n---\n\n## <a name=\"build-and-run-your-app-in-the-local-environment\"></a>在本地环境中生成并运行应用\n\n消息扩展允许你与 Web 服务交互。 它利用机器人的消息传送功能和安全通信。 消息扩展应用将添加到注册为机器人的 Web 服务。 \n\n### <a name=\"build-and-run-your-app-locally\"></a>在本地生成并运行应用\n\n1. 在 Visual Studio Code 中选择 **F5** 以在调试模式下运行应用程序。\n\n    > [!NOTE]\n    > 如果 Teams 工具包无法检查特定的先决条件，则会提示你检查它。\n\n    <!-- markdownlint-disable MD033 -->\n    <details>\n    <summary>在本地调试器中运行应用时，了解会发生什么情况。</summary>\n\n    选择 **F5** 时，Teams 工具包：\n\n    1. 检查以下所有先决条件：\n      - 你使用 Microsoft 365 帐户登录。\n      - 已为 Microsoft 365 帐户启用旁加载。\n      - 支持安装Node.js版本。\n      - 已安装 Ngrok。\n      - 机器人应用所需的端口可用。\n\n    2. 安装 npm 包\n    3. 启动 Ngrok 以创建 HTTP 隧道。\n    4. 在 Azure AD 中注册应用并配置应用。\n    5. 在 Bot Framework 中注册机器人应用并配置该应用。\n    6. 在 Teams 开发人员门户中注册应用并配置应用。\n    7. 启动本地托管的消息扩展应用。\n    8. 在 Web 浏览器中启动 Teams 并旁加载 Teams 应用。\n    \n    </details>\n\n    :::image type=\"content\" source=\"../msteams-platform/assets/images/teams-toolkit-v2/first-msgext/f5-build-and-run-mex.png\" alt-text=\"显示何时按下 F5 键进行调试的屏幕截图。\":::\n\n    > [!NOTE]\n    > 首次运行应用时，将下载所有依赖项，并生成应用。 生成完成后，将打开浏览器窗口。 此过程可能需要 3 到 5 分钟才能完成。\n\n    Teams 在 Web 浏览器中运行你的应用。\n    \n1. 如果出现提示，请使用 Microsoft 365 帐户登录。\n1. 选择“ **添加** ”，将应用添加到帐户。\n\n    :::image type=\"content\" source=\"../msteams-platform/assets/images/teams-toolkit-v2/first-msgext/add-mex-app-local-debug.png\" alt-text=\"显示要添加应用的消息的屏幕截图\":::\n\n    工具包显示一条消息，指示应用已添加到 Teams。\n\n    :::image type=\"content\" source=\"../msteams-platform/assets/images/teams-toolkit-v2/first-msgext/mex-added-local-debug.png\" alt-text=\"显示立即或稍后试用应用的消息的屏幕截图\":::\n\n    - 如果选择“ **已获取**”，则可以稍后从旁加载的应用列表中尝试该应用。\n    - 如果选择“ **试用**”，Teams 将加载你的应用。\n\n1. 选择“ **试用**”。\n\n    消息扩展应用加载到聊天机器人应用中。\n\n    :::image type=\"content\" source=\"../msteams-platform/assets/images/teams-toolkit-v2//first-msgext/app-added-mex-local-debug.png\" alt-text=\"显示 Teams 中旁加载的应用的屏幕截图\":::\n\n    由于消息扩展应用依赖于机器人来实现用户与 Web 服务之间的通信，因此应用会加载到机器人的聊天功能。\n\n    - 如果在创建消息扩展应用之前已创建机器人应用，可以看到它已加载到你创建的同一机器人应用中。 以前的聊天消息可见。\n    - 如果你先创建了消息扩展，你的应用将加载到 Teams 上打开的任何聊天中。\n\n### <a name=\"test-your-app\"></a>测试应用\n\n首次加载应用时，消息扩展应用将打开供你测试。 此示例应用允许从软件注册表中搜索开源 npm 包。\n\n#### <a name=\"to-run-a-search-query\"></a>运行搜索查询\n\n1. 让我们在搜索框中输入搜索字符串，例如“cli”。 你将获得匹配项的列表：\n\n    :::image type=\"content\" source=\"../msteams-platform/assets/images/teams-toolkit-v2//first-msgext/mex-search-string.png\" alt-text=\"显示如何使用应用进行搜索的屏幕截图\":::\n\n1. 从搜索结果中选择一个。 它将显示在撰写区域中，以便你可以将结果发送到通道。\n\n    :::image type=\"content\" source=\"../msteams-platform/assets/images/teams-toolkit-v2/first-msgext/mex-search-result.png\" alt-text=\"显示搜索结果的屏幕截图\":::\n\n1. 选择“ **发送** 说明”。\n\n    :::image type=\"content\" source=\"../msteams-platform/assets/images/teams-toolkit-v2/first-msgext/mex-search-sent.png\" alt-text=\"显示聊天时发送的搜索结果的屏幕截图\":::\n\n    现在，你已了解如何生成和运行基本消息扩展应用！         \n\n## <a name=\"optional-scenarios\"></a>可选方案\n\n你已测试基本消息扩展应用的搜索功能。 现在，可以尝试此应用的其他一些功能。 这些是此应用中的可选方案。\n<br>\n<br>\n<details>\n<summary>创建卡片</summary>\n\n1. 选择“ **创建卡片**”。\n\n    :::image type=\"content\" source=\"../msteams-platform/assets/images/teams-toolkit-v2/first-msgext/app-added-mex-local-debug.png\" alt-text=\"显示如何创建卡片的屏幕截图\":::\n\n1. 按所示输入卡片详细信息，然后选择“ **提交**”。\n\n    :::image type=\"content\" source=\"../msteams-platform/assets/images/teams-toolkit-v2/first-msgext/mex-card-details.png\" alt-text=\"显示如何添加卡片详细信息的屏幕截图\":::\n\n    卡片详细信息将显示在撰写区域中。\n\n    :::image type=\"content\" source=\"../msteams-platform/assets/images/teams-toolkit-v2/first-msgext/mex-card-added.png\" alt-text=\"显示如何添加卡片详细信息的屏幕截图\":::\n\n1. 从撰写区域中选择 **“发送** ”图标。\n\n    应用在机器人聊天中发送卡片。\n\n    :::image type=\"content\" source=\"../msteams-platform/assets/images/teams-toolkit-v2/first-msgext/mex-card-sent.png\" alt-text=\"显示已发送卡片的屏幕截图\":::\n</details>\n<br>\n<details>\n<summary>从撰写区域打开应用</summary>\n\n选择以下方法之一打开应用。\n\n* **使用 `@mention`：**\n\n1. 在应用的命令区域中输入 `@your-app-name` 。\n    \n    应用将打开搜索框，你可以使用它来运行查询。\n\n    :::image type=\"content\" source=\"../msteams-platform/assets/images/teams-toolkit-v2/first-msgext/mention-mex-app.png\" alt-text=\"显示如何@mention消息扩展应用的屏幕截图\":::\n\n1. 输入搜索字符串，并从搜索结果中选择一个。\n\n    :::image type=\"content\" source=\"../msteams-platform/assets/images/teams-toolkit-v2/first-msgext/command-box-search.png\" alt-text=\"显示如何使用邮件扩展应用运行搜索的屏幕截图\":::\n\n    它在命令区域中显示为卡片。\n\n1. 复制卡片以将其粘贴到撰写区域中。\n\n    :::image type=\"content\" source=\"../msteams-platform/assets/images/teams-toolkit-v2/first-msgext/command-search-card.png\" alt-text=\"显示卡片中的搜索结果的屏幕截图\":::\n    \n1. 使用撰写区域发送卡片。\n\n    :::image type=\"content\" source=\"../msteams-platform/assets/images/teams-toolkit-v2/first-msgext/command-search-card-sent.png\" alt-text=\"显示聊天中的搜索结果的屏幕截图\":::\n\n* **使用三点图标：**\n\n1. 从撰写区域底部的三个点启动消息扩展。\n1. 选择消息扩展应用。       \n\n    :::image type=\"content\" source=\"../msteams-platform/assets/images/teams-toolkit-v2/first-msgext/three-dot-mex.png\" alt-text=\"显示如何打开示例消息扩展应用的屏幕截图\":::\n\n    消息扩展应用会加载用于运行搜索和创建自适应卡片的选项。\n</details>\n<br>\n<details>\n<summary>从旁加载的应用运行应用</summary>\n\n可以从旁加载的应用列表中打开旁加载的 Teams 应用。 \n\n1. 从 Teams 边栏中选择 **“应用商店** ”图标。\n1. 选择“ **管理应用**”。\n\n    :::image type=\"content\" source=\"../msteams-platform/assets/images/teams-toolkit-v2/first-msgext/sideloaded-apps.png\" alt-text=\"显示旁加载应用的屏幕截图\":::\n\n1. 选择应用的三点图标，然后选择“ **查看详细信息**”。 还可以将链接复制到应用，并使用它打开应用。\n1. 选择“ **打开** ”以加载应用，然后选择“ **试用**”。 \n    \n    应用在 Teams 中加载。\n\n</details>\n<br>\n<br>\n<!-- markdownlint-disable MD033 -->\n<details>\n<summary>了解如何排查应用未在本地运行的问题。</summary>\n\n若要在 Teams 中运行应用，必须具有允许应用旁加载的 Microsoft 365 开发帐户。 可以在先决条件部分了解有关旁加载的详细信息。\n</details>\n"
- title: 部署第一个 Teams 应用
  durationInMinutes: 1
  content: "\n你已了解如何使用消息扩展功能创建、生成和运行 Teams 应用。 最后一步是在 Azure 上部署应用。\n\n让我们使用 Teams 工具包在 Azure 上部署第一个具有 Tab 功能的应用。\n\n## <a name=\"sign-in-to-your-azure-account\"></a>登录到 Azure 帐户\n\n使用此帐户访问 Microsoft Azure 门户并预配新的云资源以支持你的应用。\n\n# <a name=\"visual-studio-code\"></a>[Visual Studio Code](#tab/viscode)\n\n1. 打开 Visual Studio 代码。\n1. 打开在其中创建了选项卡应用的项目文件夹。\n1. 选择边栏中的“Teams 工具包”  :::image type=\"icon\" source=\"../msteams-platform/assets/images/teams-toolkit-v2/teams-toolkit-sidebar-icon.png\"::: 图标。\n1. 选择“ **登录到 Azure**”。\n\n    > [!TIP]\n    > 如果已安装 Azure 帐户扩展并使用相同的帐户，则可以跳过此步骤。 使用与其他扩展中使用的帐户相同的帐户。\n\n    此时会打开默认 Web 浏览器，以便登录帐户。\n1. 使用凭据登录到 Azure 帐户。\n1. 出现提示时关闭浏览器并返回到Visual Studio Code。\n\n    边栏的 **“帐户** ”部分分别显示这两个帐户。 它还列出了可用的 Azure 订阅数。 确保至少有一个可用的 Azure 订阅可用。 如果没有，请注销并使用其他帐户。\n\n    现在可以将应用部署到 Azure 了！\n\n    恭喜，你已创建 Teams 应用！ \n    现在，让我们继续了解如何使用 Teams 工具包将其中一个应用部署到 Azure。\n\n# <a name=\"command-line\"></a>[命令行](#tab/cline)\n\n1. 使用 TeamsFx CLI 登录到 Microsoft 365：\n\n    ``` bash\n    teamsfx account login m365\n    ```\n\n    此时会打开默认 Web 浏览器，以便登录帐户。 使用凭据登录到 Azure 帐户。 出现提示时关闭浏览器。\n\n2. 使用 TeamsFx CLI 登录到 Azure：\n\n    ``` bash\n    teamsfx account login azure\n    ```\n\n    此时会打开默认 Web 浏览器，以便登录帐户。 使用凭据登录到 Azure 帐户。 出现提示时关闭浏览器。\n\n    帐户登录名在 Visual Studio Code 和 TeamsFx CLI 之间共享。\n\n    恭喜，你已创建 Teams 应用！ \n    现在，让我们继续了解如何使用 Teams 工具包将其中一个应用部署到 Azure。\n\n---\n\n  [!INCLUDE [Provision and Deploy your app on Azure](~/includes/get-started/azure-provisioning-instructions.md)]\n\n  <!-- markdownlint-disable MD033 -->\n  <details>\n  <summary>了解将应用部署到 Azure 时会发生的情况</summary>\n\n  部署之前，应用程序已在本地运行:\n\n  * 后端使用 **Azure Functions Core Tools** 运行。\n  * 应用程序 HTTP 终结点 (Microsoft Teams 在此加载应用程序) 在本地运行。\n\n  部署是一个两步过程。 在活动 Azure 订阅上预配资源，然后将应用程序的后端和前端代码部署或上传到 Azure。\n\n  * 后端（如果已配置）使用各种 Azure 服务，包括Azure 应用服务和 Azure 存储。\n  * 将前端应用程序部署到配置用于静态 Web 托管的 Azure 存储帐户。\n\n  </details>\n"
- title: 祝贺你！
  durationInMinutes: 1
  content: "\n你做到了！\n\n你已创建消息扩展应用。\n\n了解如何创建基本应用后，可以继续创建更复杂的应用。 首先，请尝试向现有应用添加功能。\n\n若要向现有应用添加功能，请执行以下操作：\n\n1. 从 Teams 工具包边栏中的“**开发**”部分选择“**添加功能**”。\n\n1. 选择要添加到应用的功能。\n\n就是这么简单。 Teams 工具包将新功能的基架添加到应用的目录结构中。 按照过程生成和部署应用，你的应用将具有多个功能。 \n\n你已完成使用 JavaScript 生成消息传递扩展应用的教程。"
