---
title: 验证应用用户
description: 介绍 Teams 中的身份验证以及如何在应用中使用它
ms.topic: conceptual
keywords: teams 身份验证 OAuth SSO AAD
ms.openlocfilehash: 6ddcd8a9e847d9216b7e2dcc12733a6cd413b48e
ms.sourcegitcommit: 976e870cc925f61b76c3830ec04ba6e4bdfde32f
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 01/27/2021
ms.locfileid: "50014290"
---
# <a name="authenticating-users-in-microsoft-teams"></a><span data-ttu-id="8e5de-104">在 Microsoft Teams 中验证用户</span><span class="sxs-lookup"><span data-stu-id="8e5de-104">Authenticating users in Microsoft Teams</span></span>

> [!Note]
> <span data-ttu-id="8e5de-105">移动客户端上基于 Web 的身份验证需要 Teams JavaScript SDK 版本 1.4.1 或更高版本。</span><span class="sxs-lookup"><span data-stu-id="8e5de-105">Web-based authentication on mobile clients requires version 1.4.1 or later of the Teams JavaScript SDK.</span></span>

<span data-ttu-id="8e5de-106">为了让你的应用访问受 Azure Active Directory 保护的用户信息，以及访问来自其他服务（如 Facebook 和 Twitter）的数据，你的应用必须建立与这些提供商的信任连接。</span><span class="sxs-lookup"><span data-stu-id="8e5de-106">In order for your app to access user information protected by Azure Active Directory, as well as access data from other services like Facebook and Twitter, your app will have to establish a trusted connection with those providers.</span></span> <span data-ttu-id="8e5de-107">如果你的应用需要在用户范围内使用 Microsoft Graph API，你还需要对用户进行身份验证以检索相应的身份验证令牌。</span><span class="sxs-lookup"><span data-stu-id="8e5de-107">If your app needs to use Microsoft Graph APIs in the user scope, you'll also need to authenticate the user to retrieve the appropriate authentication tokens.</span></span>

<span data-ttu-id="8e5de-108">在 Microsoft Teams 中，你的应用有两个不同的身份验证流程可以利用。</span><span class="sxs-lookup"><span data-stu-id="8e5de-108">In Microsoft Teams there are two different authentication flows for your app to take advantage of.</span></span> <span data-ttu-id="8e5de-109">您可以在嵌入选项卡、配置页或任务模块的内容页中[](~/tabs/how-to/create-tab-pages/content-page.md)执行传统的基于 Web 的身份验证流。</span><span class="sxs-lookup"><span data-stu-id="8e5de-109">You can perform a traditional web-based authentication flow in a [content page](~/tabs/how-to/create-tab-pages/content-page.md) embedded in a tab, a configuration page, or a task module.</span></span> <span data-ttu-id="8e5de-110">如果你的应用包含对话机器人，可以使用 OAuthPrompt 流 (（可选）和 Azure Bot Framework 的令牌服务) 在对话中对用户进行身份验证。</span><span class="sxs-lookup"><span data-stu-id="8e5de-110">If your app contains a conversational bot you can use the OAuthPrompt flow (and optionally the Azure Bot Framework's token service) to authenticate a user as part of a conversation.</span></span>

## <a name="web-based-authentication-flow"></a><span data-ttu-id="8e5de-111">基于 Web 的身份验证流</span><span class="sxs-lookup"><span data-stu-id="8e5de-111">Web-based authentication flow</span></span>

<span data-ttu-id="8e5de-112">你需要对选项卡使用基于 Web 的身份验证流，并且[](~/tabs/what-are-tabs.md)可以选择与对话机器人或消息扩展一起[](~/bots/what-are-bots.md)[使用它](~/messaging-extensions/what-are-messaging-extensions.md)。</span><span class="sxs-lookup"><span data-stu-id="8e5de-112">You'll need to use the web-based authentication flow for [tabs](~/tabs/what-are-tabs.md), and can choose to use it with [conversational bots](~/bots/what-are-bots.md) or [messaging extensions](~/messaging-extensions/what-are-messaging-extensions.md).</span></span> <span data-ttu-id="8e5de-113">你将使用 Web 内容页中的 [Microsoft Teams JavaScript](/javascript/api/overview/msteams-client) 客户端 SDK 启用身份验证，然后将该内容页嵌入选项卡、配置页或任务模块中。</span><span class="sxs-lookup"><span data-stu-id="8e5de-113">You'll use the [Microsoft Teams JavaScript client SDK](/javascript/api/overview/msteams-client) in a web content page to enable authentication, then embed that content page in a tab, a configuration page, or a task module.</span></span> <span data-ttu-id="8e5de-114">如果要将基于 Web 的身份验证流与对话机器人一同使用，则需要将任务模块与自动程序 [一同使用](~/task-modules-and-cards/task-modules/task-modules-bots.md)。</span><span class="sxs-lookup"><span data-stu-id="8e5de-114">If you want to use the web-based authentication flow with a conversational bot, you'll need to [use a task module with a bot](~/task-modules-and-cards/task-modules/task-modules-bots.md).</span></span>

* <span data-ttu-id="8e5de-115">[选项卡中的身份验证流](~/tabs/how-to/authentication/auth-flow-tab.md) 介绍了选项卡身份验证在 Teams 中的工作方式。</span><span class="sxs-lookup"><span data-stu-id="8e5de-115">[Authentication flow in tabs](~/tabs/how-to/authentication/auth-flow-tab.md) describes how tab authentication works in Teams.</span></span> <span data-ttu-id="8e5de-116">这显示了用于选项卡的典型基于 Web 的身份验证流。</span><span class="sxs-lookup"><span data-stu-id="8e5de-116">This shows a typical web based authentication flow used for tabs.</span></span>
* <span data-ttu-id="8e5de-117">[选项卡中的 Azure AD](~/tabs/how-to/authentication/auth-tab-AAD.md) 身份验证描述如何从 Teams 应用中的选项卡内连接到 Azure Active Directory。</span><span class="sxs-lookup"><span data-stu-id="8e5de-117">[Azure AD authentication in tabs](~/tabs/how-to/authentication/auth-tab-AAD.md) describes how to connect to Azure Active Directory from within a tab in your app in Teams.</span></span>
* <span data-ttu-id="8e5de-118">[Azure AD (无 ](~/tabs/how-to/authentication/auth-silent-AAD.md) 提示) 介绍了如何使用 Azure Active Directory 减少应用中的登录/同意提示。</span><span class="sxs-lookup"><span data-stu-id="8e5de-118">[Silent authentication (Azure AD)](~/tabs/how-to/authentication/auth-silent-AAD.md) describes how to reduce sign-in/consent prompts in your app using Azure Active Directory.</span></span>
* <span data-ttu-id="8e5de-119">[dotnet/C# 或](https://github.com/OfficeDev/microsoft-teams-sample-complete-csharp) [JavaScript/Node.js](https://github.com/OfficeDev/microsoft-teams-sample-complete-node)</span><span class="sxs-lookup"><span data-stu-id="8e5de-119">Web-based authentication in [dotnet/C#](https://github.com/OfficeDev/microsoft-teams-sample-complete-csharp) or [JavaScript/Node.js](https://github.com/OfficeDev/microsoft-teams-sample-complete-node)</span></span>

## <a name="the-oauthprompt-flow-for-conversational-bots"></a><span data-ttu-id="8e5de-120">用于对话机器人的 OAuthPrompt 流</span><span class="sxs-lookup"><span data-stu-id="8e5de-120">The OAuthPrompt flow for conversational bots</span></span>

<span data-ttu-id="8e5de-121">Azure Bot Framework 的 OAuthPrompt 使使用对话机器人的应用更容易进行身份验证。</span><span class="sxs-lookup"><span data-stu-id="8e5de-121">The Azure Bot Framework’s OAuthPrompt makes authentication easier for apps using conversational bots.</span></span> <span data-ttu-id="8e5de-122">您还可以利用 Azure Bot Framework 的令牌服务来帮助进行令牌缓存。</span><span class="sxs-lookup"><span data-stu-id="8e5de-122">You can take advantage of Azure Bot Framework's token service to assist with token caching as well.</span></span>

<span data-ttu-id="8e5de-123">有关使用 OAuthPrompt 的信息，请参阅：</span><span class="sxs-lookup"><span data-stu-id="8e5de-123">For more information on using the OAuthPrompt see:</span></span>

* <span data-ttu-id="8e5de-124">[自动程序身份验证流概述](~/bots/how-to/authentication/auth-flow-bot.md) 介绍了身份验证在 Teams 应用中自动程序内的工作方式。</span><span class="sxs-lookup"><span data-stu-id="8e5de-124">[Bot authentication flow overview](~/bots/how-to/authentication/auth-flow-bot.md) describes how authentication works within a bot in your app in Teams.</span></span> <span data-ttu-id="8e5de-125">这显示了一个非基于 Web 的身份验证流，用于所有版本的 Teams (Web、桌面应用和移动应用上的) </span><span class="sxs-lookup"><span data-stu-id="8e5de-125">This shows a non-web based authentication flow used for bots on all versions of Teams (web, desktop app, and mobile apps)</span></span>
* [<span data-ttu-id="8e5de-126">自动程序身份验证</span><span class="sxs-lookup"><span data-stu-id="8e5de-126">Bot authentication</span></span>](~/bots/how-to/authentication/add-authentication.md)
* <span data-ttu-id="8e5de-127">在[dotnet (C#](https://github.com/microsoft/BotBuilder-Samples/tree/master/samples/csharp_dotnetcore/46.teams-auth)或[JavaScript/) ](https://github.com/microsoft/BotBuilder-Samples/tree/master/samples/javascript_nodejs/46.teams-auth) v3 SDK Node.js</span><span class="sxs-lookup"><span data-stu-id="8e5de-127">Bot authentication (v3 SDK) sample in [dotnet/C#](https://github.com/microsoft/BotBuilder-Samples/tree/master/samples/csharp_dotnetcore/46.teams-auth) or [JavaScript/Node.js](https://github.com/microsoft/BotBuilder-Samples/tree/master/samples/javascript_nodejs/46.teams-auth)</span></span>

## <a name="configure-your-identity-provider"></a><span data-ttu-id="8e5de-128">配置标识提供程序</span><span class="sxs-lookup"><span data-stu-id="8e5de-128">Configure your identity provider</span></span>

<span data-ttu-id="8e5de-129">无论你的应用使用哪种身份验证流 (你甚至可能同时使用这两) ，你都需要配置标识提供程序以与 Teams 应用通信。</span><span class="sxs-lookup"><span data-stu-id="8e5de-129">Regardless of which authentication flow your app is using (you might even be using both), you'll need to configure your identity provider to communicate with your Teams app.</span></span> <span data-ttu-id="8e5de-130">你将在此处找到的大多数示例和演练主要涉及将 Azure Active Directory 用作标识提供程序。</span><span class="sxs-lookup"><span data-stu-id="8e5de-130">The majority of the samples and walkthroughs you'll find here will deal primarily with using Azure Active Directory as your identity provider.</span></span> <span data-ttu-id="8e5de-131">但是，无论使用哪个标识提供程序，概念都适用。</span><span class="sxs-lookup"><span data-stu-id="8e5de-131">The concepts however apply regardless of which identity provider you'll use.</span></span>

<span data-ttu-id="8e5de-132">有关详细信息，请参阅 [配置标识提供程序](~/concepts/authentication/configure-identity-provider.md)</span><span class="sxs-lookup"><span data-stu-id="8e5de-132">For more information see [configuring an identity provider](~/concepts/authentication/configure-identity-provider.md)</span></span>
