---
title: 验证应用用户
description: 介绍 Teams 中的身份验证以及如何在应用中使用它
ms.topic: conceptual
localization_priority: Normal
keywords: teams 身份验证 OAuth SSO AAD
ms.openlocfilehash: 23e0e500ee041afa191e9381b6f69b4c3881c391
ms.sourcegitcommit: 825abed2f8784d2bab7407ba7a4455ae17bbd28f
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/26/2021
ms.locfileid: "52019970"
---
# <a name="authenticate-users-in-microsoft-teams"></a><span data-ttu-id="a1b26-104">在 Microsoft Teams 中对用户进行身份验证</span><span class="sxs-lookup"><span data-stu-id="a1b26-104">Authenticate users in Microsoft Teams</span></span>

> [!NOTE]
> <span data-ttu-id="a1b26-105">移动客户端上基于 Web 的身份验证需要 Microsoft Teams JavaScript SDK 版本 1.4.1 或更高版本。</span><span class="sxs-lookup"><span data-stu-id="a1b26-105">Web-based authentication on mobile clients requires version 1.4.1 or later of the Microsoft Teams JavaScript SDK.</span></span>

<span data-ttu-id="a1b26-106">若要访问受 Azure Active Directory (AAD) 保护的用户信息，以及访问 Facebook 和 Twitter 等服务的数据，应用需要与这些提供商建立受信任的连接。</span><span class="sxs-lookup"><span data-stu-id="a1b26-106">To access user information protected by Azure Active Directory (AAD) and to access data from services like Facebook and Twitter, the app establishes a trusted connection with those providers.</span></span> <span data-ttu-id="a1b26-107">如果应用在用户范围内使用 Microsoft Graph API，请对用户进行身份验证以检索相应的身份验证令牌。</span><span class="sxs-lookup"><span data-stu-id="a1b26-107">If the app uses Microsoft Graph APIs in the user scope, authenticate the user to retrieve the appropriate authentication tokens.</span></span>

<span data-ttu-id="a1b26-108">在 Teams 中，应用有两个不同的身份验证流。</span><span class="sxs-lookup"><span data-stu-id="a1b26-108">In Teams, there are two different authentication flows for the app.</span></span> <span data-ttu-id="a1b26-109">在嵌入选项卡、配置页或任务模块的内容[](~/tabs/how-to/create-tab-pages/content-page.md)页中执行传统的基于 Web 的身份验证流。</span><span class="sxs-lookup"><span data-stu-id="a1b26-109">Perform a traditional web-based authentication flow in a [content page](~/tabs/how-to/create-tab-pages/content-page.md) embedded in a tab, a configuration page, or a task module.</span></span> <span data-ttu-id="a1b26-110">如果应用包含对话机器人，请使用 OAuthPrompt 流和 Azure Bot Framework 的令牌服务（可选）将用户作为对话的一部分进行身份验证。</span><span class="sxs-lookup"><span data-stu-id="a1b26-110">If the app contains a conversational bot, use the OAuthPrompt flow and optionally the Azure Bot Framework's token service to authenticate a user as part of a conversation.</span></span>

## <a name="web-based-authentication-flow"></a><span data-ttu-id="a1b26-111">基于 Web 的身份验证流</span><span class="sxs-lookup"><span data-stu-id="a1b26-111">Web-based authentication flow</span></span>

<span data-ttu-id="a1b26-112">对选项卡使用基于 Web 的[](~/tabs/what-are-tabs.md)身份验证流，并选择与对话机器人[](~/bots/what-are-bots.md)或消息扩展[一起使用它](~/messaging-extensions/what-are-messaging-extensions.md)。</span><span class="sxs-lookup"><span data-stu-id="a1b26-112">Use the web-based authentication flow for [tabs](~/tabs/what-are-tabs.md) and choose to use it with [conversational bots](~/bots/what-are-bots.md) or [messaging extensions](~/messaging-extensions/what-are-messaging-extensions.md).</span></span> <span data-ttu-id="a1b26-113">使用 [Web 内容页中的 Microsoft Teams JavaScript](/javascript/api/overview/msteams-client) 客户端 SDK 启用身份验证。</span><span class="sxs-lookup"><span data-stu-id="a1b26-113">Use the [Microsoft Teams JavaScript client SDK](/javascript/api/overview/msteams-client) in a web content page to enable authentication.</span></span> <span data-ttu-id="a1b26-114">启用身份验证后，在选项卡、配置页或任务模块中嵌入内容页。</span><span class="sxs-lookup"><span data-stu-id="a1b26-114">After enabling authentication, embed the content page in a tab, a configuration page, or a task module.</span></span> <span data-ttu-id="a1b26-115">有关基于 Web 的身份验证流详细信息，请参阅：</span><span class="sxs-lookup"><span data-stu-id="a1b26-115">For more information on web-based authentication flow, see:</span></span>

* <span data-ttu-id="a1b26-116">[向 Teams 机器人添加身份验证](~/bots/how-to/authentication/add-authentication.md) 介绍如何将基于 Web 的身份验证流与对话机器人一同使用。</span><span class="sxs-lookup"><span data-stu-id="a1b26-116">[Add authentication to the Teams bot](~/bots/how-to/authentication/add-authentication.md) describes how to use web-based authentication flow with a conversational bot.</span></span>
* <span data-ttu-id="a1b26-117">[选项卡中的身份验证流](~/tabs/how-to/authentication/auth-flow-tab.md) 介绍了选项卡身份验证在 Teams 中的工作方式。</span><span class="sxs-lookup"><span data-stu-id="a1b26-117">[Authentication flow in tabs](~/tabs/how-to/authentication/auth-flow-tab.md) describes how tab authentication works in Teams.</span></span> <span data-ttu-id="a1b26-118">这将显示用于选项卡的典型基于 Web 的身份验证流。</span><span class="sxs-lookup"><span data-stu-id="a1b26-118">This shows a typical web-based authentication flow used for tabs.</span></span>
* <span data-ttu-id="a1b26-119">[选项卡中的 AAD](~/tabs/how-to/authentication/auth-tab-AAD.md) 身份验证介绍如何从 Teams 应用中的选项卡内连接到 AAD。</span><span class="sxs-lookup"><span data-stu-id="a1b26-119">[AAD authentication in tabs](~/tabs/how-to/authentication/auth-tab-AAD.md) describes how to connect to AAD from within a tab in the app in Teams.</span></span>
* <span data-ttu-id="a1b26-120">[无提示身份验证 AAD](~/tabs/how-to/authentication/auth-silent-AAD.md) 介绍如何使用 AAD 减少应用中的登录或同意提示。</span><span class="sxs-lookup"><span data-stu-id="a1b26-120">[Silent authentication AAD](~/tabs/how-to/authentication/auth-silent-AAD.md) describes how to reduce sign-in or consent prompts in the app using AAD.</span></span>
* <span data-ttu-id="a1b26-121">[.Net、C#、JavaScript](https://github.com/OfficeDev/microsoft-teams-sample-complete-csharp) [或 Node.js](https://github.com/OfficeDev/microsoft-teams-sample-complete-node) 提供了基于 Web 的身份验证的示例。</span><span class="sxs-lookup"><span data-stu-id="a1b26-121">[.Net or C#](https://github.com/OfficeDev/microsoft-teams-sample-complete-csharp) or [JavaScript or Node.js](https://github.com/OfficeDev/microsoft-teams-sample-complete-node) provides samples for web-based authentication.</span></span>

## <a name="the-oauthprompt-flow-for-conversational-bots"></a><span data-ttu-id="a1b26-122">用于对话机器人的 OAuthPrompt 流</span><span class="sxs-lookup"><span data-stu-id="a1b26-122">The OAuthPrompt flow for conversational bots</span></span>

<span data-ttu-id="a1b26-123">Azure Bot Framework 的 OAuthPrompt 使使用对话机器人的应用更容易进行身份验证。</span><span class="sxs-lookup"><span data-stu-id="a1b26-123">The Azure Bot Framework’s OAuthPrompt makes authentication easier for apps using conversational bots.</span></span> <span data-ttu-id="a1b26-124">使用 Azure Bot Framework 的令牌服务来帮助进行令牌缓存。</span><span class="sxs-lookup"><span data-stu-id="a1b26-124">Use Azure Bot Framework's token service to assist with token caching.</span></span>

<span data-ttu-id="a1b26-125">有关使用 OAuthPrompt 的信息，请参阅：</span><span class="sxs-lookup"><span data-stu-id="a1b26-125">For more information on using the OAuthPrompt, see:</span></span>

* <span data-ttu-id="a1b26-126">[自动程序身份验证流概述](~/bots/how-to/authentication/auth-flow-bot.md) 介绍了身份验证在 Teams 应用中自动程序内的工作方式。</span><span class="sxs-lookup"><span data-stu-id="a1b26-126">[Bot authentication flow overview](~/bots/how-to/authentication/auth-flow-bot.md) describes how authentication works within a bot in the app in Teams.</span></span> <span data-ttu-id="a1b26-127">这显示了用于 Teams Web、桌面应用和移动应用上的自动程序的非基于 Web 的身份验证流。</span><span class="sxs-lookup"><span data-stu-id="a1b26-127">This shows a non-web-based authentication flow used for bots on Teams web, desktop app, and mobile apps.</span></span>
* <span data-ttu-id="a1b26-128">[自动程序](~/bots/how-to/authentication/add-authentication.md) 身份验证介绍如何将 OAuth 身份验证添加到 Teams 自动程序。</span><span class="sxs-lookup"><span data-stu-id="a1b26-128">[Bot authentication](~/bots/how-to/authentication/add-authentication.md) describes how to add OAuth authentication to the Teams bot.</span></span>

## <a name="code-sample"></a><span data-ttu-id="a1b26-129">代码示例</span><span class="sxs-lookup"><span data-stu-id="a1b26-129">Code sample</span></span>

<span data-ttu-id="a1b26-130">提供 Bot 身份验证 v3 SDK 示例。</span><span class="sxs-lookup"><span data-stu-id="a1b26-130">provides Bot authentication v3 SDK sample.</span></span>

| <span data-ttu-id="a1b26-131">**示例名称**</span><span class="sxs-lookup"><span data-stu-id="a1b26-131">**Sample name**</span></span> | <span data-ttu-id="a1b26-132">**描述**</span><span class="sxs-lookup"><span data-stu-id="a1b26-132">**Description**</span></span> | <span data-ttu-id="a1b26-133">**.NET**</span><span class="sxs-lookup"><span data-stu-id="a1b26-133">**.NET**</span></span> | <span data-ttu-id="a1b26-134">**Node.js**</span><span class="sxs-lookup"><span data-stu-id="a1b26-134">**Node.js**</span></span> | <span data-ttu-id="a1b26-135">**Python**</span><span class="sxs-lookup"><span data-stu-id="a1b26-135">**Python**</span></span> |
|---------------|------------|------------|-------------|---------------|
| <span data-ttu-id="a1b26-136">自动程序身份验证</span><span class="sxs-lookup"><span data-stu-id="a1b26-136">Bot authentication</span></span> | <span data-ttu-id="a1b26-137">此示例演示如何开始使用 Microsoft Teams 自动程序中的身份验证。</span><span class="sxs-lookup"><span data-stu-id="a1b26-137">This sample shows how to get started with authentication in a bot for Microsoft Teams.</span></span> | [<span data-ttu-id="a1b26-138">View</span><span class="sxs-lookup"><span data-stu-id="a1b26-138">View</span></span>](https://github.com/microsoft/BotBuilder-Samples/tree/master/samples/csharp_dotnetcore/46.teams-auth) | [<span data-ttu-id="a1b26-139">View</span><span class="sxs-lookup"><span data-stu-id="a1b26-139">View</span></span>](https://github.com/microsoft/BotBuilder-Samples/tree/master/samples/javascript_nodejs/46.teams-auth) | [<span data-ttu-id="a1b26-140">View</span><span class="sxs-lookup"><span data-stu-id="a1b26-140">View</span></span>](https://github.com/microsoft/BotBuilder-Samples/tree/main/samples/python/46.teams-auth) |

## <a name="configure-the-identity-provider"></a><span data-ttu-id="a1b26-141">配置标识提供程序</span><span class="sxs-lookup"><span data-stu-id="a1b26-141">Configure the identity provider</span></span>

<span data-ttu-id="a1b26-142">无论应用的身份验证流如何，配置标识提供程序以与 Teams 应用通信。</span><span class="sxs-lookup"><span data-stu-id="a1b26-142">Regardless of the app's authentication flow, configure the identity provider to communicate with the Teams app.</span></span> <span data-ttu-id="a1b26-143">大多数示例和演练主要涉及将 AAD 用作标识提供程序。</span><span class="sxs-lookup"><span data-stu-id="a1b26-143">Most samples and walkthroughs primarily deal with using AAD as the identity provider.</span></span> <span data-ttu-id="a1b26-144">但是，无论标识提供程序如何，概念都适用。</span><span class="sxs-lookup"><span data-stu-id="a1b26-144">The concepts, however, apply regardless of the identity provider.</span></span>

<span data-ttu-id="a1b26-145">有关详细信息，请参阅 [配置标识提供程序](~/concepts/authentication/configure-identity-provider.md)。</span><span class="sxs-lookup"><span data-stu-id="a1b26-145">For more information, see [configuring an identity provider](~/concepts/authentication/configure-identity-provider.md).</span></span>
