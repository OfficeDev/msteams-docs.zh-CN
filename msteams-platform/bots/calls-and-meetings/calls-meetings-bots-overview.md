---
title: 通话和联机会议机器人
description: 了解 Microsoft Teams 应用如何使用语音和视频与用户交互，使用 Microsoft Graph API 进行通话和联机会议。
keywords: 呼叫呼叫 音频视频 IVR 语音联机会议
ms.openlocfilehash: 0fcf420ba8d698404d00bb2cab3d61cab2245f40
ms.sourcegitcommit: 49d1ecda14042bf3f368b14c1971618fe979b914
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 03/23/2021
ms.locfileid: "51034640"
---
# <a name="calls-and-online-meetings-bots"></a><span data-ttu-id="c9e4c-104">通话和联机会议机器人</span><span class="sxs-lookup"><span data-stu-id="c9e4c-104">Calls and online meetings bots</span></span>

<span data-ttu-id="c9e4c-105">通过添加用于通话和联机会议的 [Microsoft Graph API，Microsoft](/graph/api/resources/communications-api-overview?view=graph-rest-beta&preserve-view=true)Teams 应用现在可以通过多种使用语音和视频的方式与用户进行交互。</span><span class="sxs-lookup"><span data-stu-id="c9e4c-105">With the addition of [Microsoft Graph APIs for calls and online meetings](/graph/api/resources/communications-api-overview?view=graph-rest-beta&preserve-view=true), Microsoft Teams apps can now interact with users in rich ways using voice and video.</span></span> <span data-ttu-id="c9e4c-106">这些 API 允许你添加新功能，例如交互式语音响应 (IVR) 、呼叫控制，以及访问通话和会议实时音频流和/或视频流，包括桌面应用共享。</span><span class="sxs-lookup"><span data-stu-id="c9e4c-106">These APIs allow you to add new features such as interactive voice response (IVR), call control, and access to real-time audio and/or video streams for calls and meetings, including desktop and app sharing.</span></span>

<span data-ttu-id="c9e4c-107">若要在 Microsoft Teams 应用中使用这些 Microsoft Graph API，你可以创建一个自动程序并指定一些附加信息和权限，我们将在其他地方介绍这些信息和权限，但首先，了解一些核心概念、术语和约定非常重要：</span><span class="sxs-lookup"><span data-stu-id="c9e4c-107">To use these Microsoft Graph APIs in a Microsoft Teams app, you create a bot and specify some additional information and permissions which we'll describe elsewhere, but first, it's important to understand some core concepts, terminology, and conventions:</span></span>

* <span data-ttu-id="c9e4c-108">**音频/视频呼叫。**</span><span class="sxs-lookup"><span data-stu-id="c9e4c-108">**Audio/video calls.**</span></span> <span data-ttu-id="c9e4c-109">Teams 中的通话可以纯音频或音频+视频。</span><span class="sxs-lookup"><span data-stu-id="c9e4c-109">Calls in Teams can be purely audio or audio+video.</span></span> <span data-ttu-id="c9e4c-110">为简单起见，我们不会在任何地方都说"音频/视频呼叫";我们只需说"呼叫"。</span><span class="sxs-lookup"><span data-stu-id="c9e4c-110">For brevity's sake, we don't say "audio/video call" everywhere; we just say "call."</span></span>
* <span data-ttu-id="c9e4c-111">**呼叫类型。**</span><span class="sxs-lookup"><span data-stu-id="c9e4c-111">**Call types.**</span></span> <span data-ttu-id="c9e4c-112">呼叫是一个人与机器人 (之间的对等呼叫) 或多方 (机器人和两个或多个群组通话) 。</span><span class="sxs-lookup"><span data-stu-id="c9e4c-112">Calls are either peer-to-peer (between a person and your bot) or multiparty (your bot and two or more people in a group call).</span></span>
  <span data-ttu-id="c9e4c-113">![CallingTypes ](~/assets/images/calls-and-meetings/call-types.png) ：</span><span class="sxs-lookup"><span data-stu-id="c9e4c-113">![CallingTypes](~/assets/images/calls-and-meetings/call-types.png):</span></span>
  * <span data-ttu-id="c9e4c-114">用户可以使用机器人发起对等呼叫，或邀请机器人加入现有多方呼叫 (尽管 Microsoft Teams UI 服务中尚未启用后者) 。</span><span class="sxs-lookup"><span data-stu-id="c9e4c-114">A user may initiate a peer-to-peer call with your bot or invite your bot into an existing multiparty call (although the latter is not yet enabled in the Microsoft Teams UI).</span></span>
  
  > [!NOTE]
  > <span data-ttu-id="c9e4c-115">Microsoft Teams 移动平台当前不支持用户发起的机器人呼叫。</span><span class="sxs-lookup"><span data-stu-id="c9e4c-115">User initiated calls to a bot are currently not supported on Microsoft Teams mobile platform.</span></span> 
  
  * <span data-ttu-id="c9e4c-116">用户无需使用 Microsoft Graph 权限通过机器人发起对等呼叫，但机器人需要其他权限才能参与多方呼叫，或者自动程序需要其他权限才能与用户发起对等呼叫。</span><span class="sxs-lookup"><span data-stu-id="c9e4c-116">Microsoft Graph permissions aren't necessary for a user to initiate a peer-to-peer call with your bot, but additional permissions are needed for your bot to participate in a multiparty call, or for your bot to initiate a peer-to-peer call with a user.</span></span>
  * <span data-ttu-id="c9e4c-117">呼叫可以点对点开始并升级为多方。</span><span class="sxs-lookup"><span data-stu-id="c9e4c-117">A call may start as peer-to-peer and escalate to multiparty.</span></span> <span data-ttu-id="c9e4c-118">如果你的机器人拥有适当的权限，则机器人可以通过邀请其他人来发起此升级。</span><span class="sxs-lookup"><span data-stu-id="c9e4c-118">Your bot can initiate this escalation by inviting others, provided your bot has the proper permissions.</span></span> <span data-ttu-id="c9e4c-119">如果你的机器人没有参与组呼叫的权限，并且一个参与者添加了另一方，则你的机器人会从通话中被删除。</span><span class="sxs-lookup"><span data-stu-id="c9e4c-119">If your bot doesn't have permissions to participate in group calls and one participant adds another party, your bot is dropped from the call.</span></span>
* <span data-ttu-id="c9e4c-120">**信号。**</span><span class="sxs-lookup"><span data-stu-id="c9e4c-120">**Signaling.**</span></span> <span data-ttu-id="c9e4c-121">有两种类型的信号 - 传入呼叫和呼叫内信号：</span><span class="sxs-lookup"><span data-stu-id="c9e4c-121">There are two types of signals — incoming call and in-call:</span></span>
  * <span data-ttu-id="c9e4c-122">若要接收传入呼叫，您可以在自动程序设置中指定终结点;传入呼叫到达时，此终结点将收到通知。</span><span class="sxs-lookup"><span data-stu-id="c9e4c-122">To receive an incoming call, you specify an endpoint in your bot settings; this endpoint receives a notification when an incoming call arrives.</span></span> <span data-ttu-id="c9e4c-123">可以应答呼叫、拒绝呼叫或将其重定向到其他位置或其他人。</span><span class="sxs-lookup"><span data-stu-id="c9e4c-123">You can answer the call, reject it, or redirect it to somewhere or someone else.</span></span>
  <span data-ttu-id="c9e4c-124">![呼叫类型](~/assets/images/calls-and-meetings/call-handling.png)</span><span class="sxs-lookup"><span data-stu-id="c9e4c-124">![Call Types](~/assets/images/calls-and-meetings/call-handling.png)</span></span>
  * <span data-ttu-id="c9e4c-125">当机器人在通话中时，存在用于将自身静音和取消静音以及开始/停止与其他参与者共享视频/桌面内容的 API。</span><span class="sxs-lookup"><span data-stu-id="c9e4c-125">When a bot is in a call, there are APIs for muting and unmuting itself and to start/stop sharing video/desktop content with the other participants.</span></span>
  * <span data-ttu-id="c9e4c-126">机器人还可以访问参与者列表、邀请新参与者并将其静音。</span><span class="sxs-lookup"><span data-stu-id="c9e4c-126">The bot can also access the list of participants, invite new participants, and mute them.</span></span>
* <span data-ttu-id="c9e4c-127">**通话和联机会议。**</span><span class="sxs-lookup"><span data-stu-id="c9e4c-127">**Calls and online meetings.**</span></span> <span data-ttu-id="c9e4c-128">从 Teams 用户的角度来看，有两种类型的联机会议— 临时和计划。</span><span class="sxs-lookup"><span data-stu-id="c9e4c-128">From a Teams user's perspective, there are two kinds of online meetings — ad hoc and scheduled.</span></span> <span data-ttu-id="c9e4c-129">但是，从自动程序的角度来看，这两者是相同的。</span><span class="sxs-lookup"><span data-stu-id="c9e4c-129">However, from a bot's perspective, both are the same.</span></span> <span data-ttu-id="c9e4c-130">对于机器人，联机会议只是多方呼叫 (一组参与者) 加上"会议坐标"，你可以将这些呼叫视为会议元数据：、与会议关联的、 、 等。 `botId` `chatId` `joinUrl` `startTime` / `endTime`</span><span class="sxs-lookup"><span data-stu-id="c9e4c-130">To a bot, an online meeting is just a multiparty call (the set of participants) plus "meeting coordinates," which you can think of as the metadata for the meeting: `botId`, `chatId` associated with the meeting, `joinUrl`, `startTime`/`endTime`, and more.</span></span>
* <span data-ttu-id="c9e4c-131">**实时媒体。**</span><span class="sxs-lookup"><span data-stu-id="c9e4c-131">**Real-time media.**</span></span> <span data-ttu-id="c9e4c-132">当机器人参与呼叫或联机会议时，它必须处理音频和视频流。</span><span class="sxs-lookup"><span data-stu-id="c9e4c-132">When a bot is participating in a call or online meeting, it must deal with audio and video streams.</span></span> <span data-ttu-id="c9e4c-133">当用户在通话中通话、在摄像头上显示自己或在会议中显示其屏幕时，机器人会"看到"这一点作为音频流和/或视频流。</span><span class="sxs-lookup"><span data-stu-id="c9e4c-133">When users talk on a call, show themselves on a webcam, or present their screens in a meeting, a bot "sees" this as audio and/or video streams.</span></span> <span data-ttu-id="c9e4c-134">如果机器人想要说出内容或显示屏幕内容，则需要音频或视频流。</span><span class="sxs-lookup"><span data-stu-id="c9e4c-134">If a bot wants to say something or present screen content, that requires an audio or video stream.</span></span> <span data-ttu-id="c9e4c-135">甚至像机器人在 IVR 中说"按 0 到达接线员"一样简单 (互动语音响应) 播放 。WAV 文件。</span><span class="sxs-lookup"><span data-stu-id="c9e4c-135">Even something as simple as the bot saying, "press 0 to reach the operator" in an IVR (interactive voice response) scenario means playing a .WAV file.</span></span> <span data-ttu-id="c9e4c-136">我们统称为媒体或实时媒体 (是指必须实时处理媒体的方案，而不是播放以前录制的音频/视频) 。</span><span class="sxs-lookup"><span data-stu-id="c9e4c-136">Collectively, we refer to this as _media_ or _real-time media_ (when referring to scenarios where media must be processed in real time, as opposed to playback of previously-recorded audio/video).</span></span> <span data-ttu-id="c9e4c-137">过去，处理媒体流（尤其是实时媒体流）对于开发人员来说非常复杂。</span><span class="sxs-lookup"><span data-stu-id="c9e4c-137">Historically, dealing with media streams, particularly real-time media streams, has been extremely complex for developers.</span></span> <span data-ttu-id="c9e4c-138">Microsoft 已创建 _实时媒体_ 平台来处理这些用例，并尽可能卸载传统"繁重"实时媒体处理。</span><span class="sxs-lookup"><span data-stu-id="c9e4c-138">Microsoft has created the _Real-time Media Platform_ to handle these use cases and to offload as much of the traditional "heavy lifting" of real-time media processing as possible.</span></span>  <span data-ttu-id="c9e4c-139">当机器人接听来电或加入新呼叫或现有呼叫时，需要告诉实时媒体平台如何处理媒体。</span><span class="sxs-lookup"><span data-stu-id="c9e4c-139">When the bot answers an incoming call, or joins a new or existing call, it needs to tell the Real-time Media Platform how media will be handled.</span></span> <span data-ttu-id="c9e4c-140">如果要构建 IVR 应用程序，可以将昂贵的音频处理卸载到 Microsoft。</span><span class="sxs-lookup"><span data-stu-id="c9e4c-140">If you're building an IVR application, you can offload the expensive audio processing to Microsoft.</span></span> <span data-ttu-id="c9e4c-141">或者，如果你的机器人需要直接访问媒体流，我们也支持该方案。</span><span class="sxs-lookup"><span data-stu-id="c9e4c-141">Alternatively, if your bot requires direct access to media streams, we support that scenario too.</span></span> <span data-ttu-id="c9e4c-142">有两种类型的媒体处理：</span><span class="sxs-lookup"><span data-stu-id="c9e4c-142">There are the two types of media processing:</span></span>
  * <span data-ttu-id="c9e4c-143">**服务托管的媒体。**</span><span class="sxs-lookup"><span data-stu-id="c9e4c-143">**Service-hosted media.**</span></span> <span data-ttu-id="c9e4c-144">机器人专注于管理应用程序工作流 (例如，将呼叫路由到) ，以及将音频处理卸载到 Microsoft 实时媒体平台。</span><span class="sxs-lookup"><span data-stu-id="c9e4c-144">Bots focus on managing application workflow (e.g., routing calls) and offload audio processing to the Microsoft Real-time Media Platform.</span></span> <span data-ttu-id="c9e4c-145">借助服务托管的媒体，有几种实现和托管机器人的选项。</span><span class="sxs-lookup"><span data-stu-id="c9e4c-145">With service-hosted media, you have several options to implement and host your bot.</span></span> <span data-ttu-id="c9e4c-146">服务托管的媒体自动程序可以实施为无状态服务，因为它不在本地处理媒体。</span><span class="sxs-lookup"><span data-stu-id="c9e4c-146">A service-hosted media bot can be implemented as a stateless service since it doesn't process media locally.</span></span> <span data-ttu-id="c9e4c-147">服务托管的媒体机器人可以使用 API，例如播放音频剪辑、录制音频剪辑或订阅 DTMF 音调 (例如，知道用户何时按 0 到达话务员 `PlayPrompt` `Record` `SubscribeToTone`) 。</span><span class="sxs-lookup"><span data-stu-id="c9e4c-147">Service-hosted media bots can use APIs such as `PlayPrompt` for playing an audio clip, `Record` for recording audio clips, or `SubscribeToTone` for subscribing to DTMF tones (e.g., knowing when a user has pressed 0 to reach the operator).</span></span>
  * <span data-ttu-id="c9e4c-148">**应用程序托管的媒体。**</span><span class="sxs-lookup"><span data-stu-id="c9e4c-148">**Application-hosted media.**</span></span> <span data-ttu-id="c9e4c-149">若要让机器人直接访问媒体，它需要特定的 Graph 权限，但一旦机器人拥有该权限，实时媒体库和[](https://www.nuget.org/packages/Microsoft.Graph.Communications.Calls.Media/)Graph 调用[SDK](https://microsoftgraph.github.io/microsoft-graph-comms-samples/docs/articles/index.html#graph-calling-sdk-and-stateful-client-builder)可帮助你生成丰富的实时媒体，调用机器人。</span><span class="sxs-lookup"><span data-stu-id="c9e4c-149">For a bot to get direct access to the media, it needs a specific Graph permission, but once your bot has it, the [Real-time Media Library](https://www.nuget.org/packages/Microsoft.Graph.Communications.Calls.Media/) and the [Graph Calling SDK](https://microsoftgraph.github.io/microsoft-graph-comms-samples/docs/articles/index.html#graph-calling-sdk-and-stateful-client-builder) helps you build rich, real-time media, calling bots.</span></span> <span data-ttu-id="c9e4c-150">应用程序托管的自动程序必须托管在 Windows 环境中，如此处所 [介绍的更多详细信息](./requirements-considerations-application-hosted-media-bots.md)。</span><span class="sxs-lookup"><span data-stu-id="c9e4c-150">An Application-hosted bot must be hosted in a Windows environment, as described in more detail [here](./requirements-considerations-application-hosted-media-bots.md).</span></span>

## <a name="further-reading"></a><span data-ttu-id="c9e4c-151">进一步阅读</span><span class="sxs-lookup"><span data-stu-id="c9e4c-151">Further reading</span></span>

<span data-ttu-id="c9e4c-152">下面详细了解如何创建和测试通话和联机会议机器人：</span><span class="sxs-lookup"><span data-stu-id="c9e4c-152">Here's more information on how to create and test calls and online meetings bots:</span></span>

* [<span data-ttu-id="c9e4c-153">图形 API 参考</span><span class="sxs-lookup"><span data-stu-id="c9e4c-153">Graph API reference</span></span>](/graph/api/resources/communications-api-overview?view=graph-rest-beta&preserve-view=true)
* [<span data-ttu-id="c9e4c-154">示例应用</span><span class="sxs-lookup"><span data-stu-id="c9e4c-154">Sample apps</span></span>](https://github.com/microsoftgraph/microsoft-graph-comms-samples)
* <span data-ttu-id="c9e4c-155">[注册支持通话和联机](./registering-calling-bot.md) 会议的机器人，以及针对通话和联机会议机器人的 [Microsoft Graph 权限](./registering-calling-bot.md#add-microsoft-graph-permissions)</span><span class="sxs-lookup"><span data-stu-id="c9e4c-155">[Registering a bot that supports calls and online meetings](./registering-calling-bot.md) and [Microsoft Graph permissions for calls and online meetings bots](./registering-calling-bot.md#add-microsoft-graph-permissions)</span></span>
* [<span data-ttu-id="c9e4c-156">如何在本地电脑上开发通话和联机会议机器人</span><span class="sxs-lookup"><span data-stu-id="c9e4c-156">How to develop calling and online meeting bots on your local PC</span></span>](./debugging-local-testing-calling-meeting-bots.md)
* <span data-ttu-id="c9e4c-157">[有关实时媒体处理以及](./real-time-media-concepts.md)支持应用程序托管媒体 [所需的内容详细信息](./requirements-considerations-application-hosted-media-bots.md)</span><span class="sxs-lookup"><span data-stu-id="c9e4c-157">[More information on real-time media processing](./real-time-media-concepts.md), and [what's needed to support application-hosted media](./requirements-considerations-application-hosted-media-bots.md)</span></span>
* [<span data-ttu-id="c9e4c-158">有关处理传入呼叫通知的技术信息</span><span class="sxs-lookup"><span data-stu-id="c9e4c-158">Technical information on handling incoming call notifications</span></span>](./call-notifications.md)
