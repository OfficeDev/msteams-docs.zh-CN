---
title: 实时媒体通话和在线会议与Microsoft Teams
description: 了解构建可进行实时音频和视频呼叫和联机会议的机器人的关键概念。
ms.topic: conceptual
localization_priority: Normal
keywords: 音频流视频流 音频/视频呼叫会议实时媒体应用程序托管的媒体服务托管的媒体
ms.openlocfilehash: 23a4573c39968f3b5c53badc32fd80ecc4dc889087dd8d98253be9d46555919c
ms.sourcegitcommit: 3ab1cbec41b9783a7abba1e0870a67831282c3b5
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/07/2021
ms.locfileid: "57709543"
---
# <a name="real-time-media-calls-and-meetings-with-microsoft-teams"></a>实时媒体通话和与会议Microsoft Teams

实时媒体平台允许机器人使用实时Microsoft Teams、视频和屏幕共享与通话和会议进行交互。 实时媒体平台是一项高级功能，允许机器人按帧发送和接收语音和视频内容帧。 机器人可以原始访问语音、视频和屏幕共享媒体流。 还有更简单的服务托管媒体机器人，它们依赖于实时媒体平台进行所有媒体处理。 处理媒体本身的机器人称为应用程序托管的媒体机器人。

例如，在 1：1 与机器人通话中，在用户说话时，机器人每秒接收 50 个音频帧。 自动程序接收音频帧，每帧 20 毫秒 (毫秒) 音频。 应用程序托管的媒体机器人可以在接收音频帧时执行实时语音识别。 用户停止说话后无需等待录制。 机器人还可以发送和接收高分辨率视频，包括基于视频的屏幕共享内容。

该平台为机器人提供了一个与套接字类似的简单 API，用于发送和接收媒体。 它处理音频或视频数据包实时编码和解码。 它针对音频使用编码解码器（如一些，而将 G.722 和 H.264 用于视频）。 该平台还处理所有媒体数据包加密或解密以及数据包网络传输。 机器人只关注实际的音频或视频内容。 实时媒体机器人与多个参与者一对一参与通话和会议。

## <a name="media-session"></a>媒体会话

实时媒体机器人必须声明必须支持哪些形式。 实时媒体机器人必须在应答传入呼叫或加入会议时声明Teams支持。 对于每个受支持的形式，机器人声明它可以发送和接收媒体、仅接收还是仅发送。 例如，设计为处理 1：1 Teams呼叫的机器人需要发送和接收音频。 但是机器人只需要发送视频，因为它不需要接收呼叫者的视频。 自动程序与呼叫者或会议之间建立的音频和视频形式Teams称为媒体会话。

支持两种类型的视频形式，主要基于视频和基于视频的屏幕共享。 主视频用于从用户的摄像头传输视频。 基于视频的屏幕共享允许用户共享屏幕。 该平台允许机器人发送和接收这两种视频类型。

加入会议Teams，机器人可以同时接收多个主要视频流，每个媒体会话最多 10 个。 机器人可以在会议中查看多个参与者。

下一节提供有关自动程序以帧序列发送和接收媒体的详细信息。

## <a name="frames-and-frame-rate"></a>帧和帧速率

实时媒体机器人直接与媒体会话的音频和视频形式交互。 机器人将发送和接收媒体作为一系列帧，并且每个帧都是一个内容单元。 一秒的音频作为 50 帧的序列传输。 每个帧包含 20 毫秒，即语音内容的 1/50。 视频的一秒以 30 个静止图像序列传输。 每个图像仅可查看 33.3 毫秒，即下一个视频帧前的 1/30 秒。 每秒传输或呈现的帧数称为帧速率。

下一节提供有关实时媒体呼叫和会议中使用的音频和视频格式的详细信息。

## <a name="audio-and-video-format"></a>音频和视频格式

在音频格式中，音频的每秒钟表示为 16，000 个样本，每个样本包含 16 位数据。 20 毫秒的音频帧包含 320 个样本，这些样本是 640 字节的数据。

在视频格式中，支持多种格式。 视频格式的两个关键属性是帧大小和颜色格式。 受支持的帧大小包括 640x360（即 360 像素、1280x720 为 720 像素）和 1920x1080（即 1080 像素）。 支持的颜色格式包括每像素 12 位的 NV12 和每像素 24 位的 RGB24。

720 p 视频帧包含 921，600 像素，即 1280 倍 720 像素。 在 RGB24 颜色格式中，每个像素表示为 3 个字节，即 24 位，包括每个红色、绿色和蓝色分量的 1 个字节。 单个 720p RGB24 视频帧需要 2，764，800 字节的数据，即每个像素 921，600 像素 x 3 字节。 在可变帧速率下，发送 720p RGB24 视频帧意味着每秒处理大约 80 MB 的内容。 在网络传输之前，H.264 视频编解码器会显著压缩 80 MB。

平台的高级功能允许机器人以编码的 H.264 帧发送或接收视频。 支持提供其自己的 H.264 编码器或解码器的机器人，或者不需要解码为原始 RGB24 或 NV12 位图的视频流。

下一节详细介绍哪些会议参与者在说话，哪些与会者是活动且惯用的发言人。

## <a name="active-and-dominant-speakers"></a>主动和基准扬声器

加入由多个Teams加入会议时，机器人可以识别当前正在说话的会议参与者。 活动扬声器确定在每个收到的音频帧中听到的参与者。 基准扬声器确定哪些参与者当前在组对话中最活跃或最惯用，尽管每个音频帧中都未听到他们的声音。 当不同的参与者轮次说话时，一组惯用说话的人可能会更改。

下一节提供有关机器人提出的视频订阅请求的详细信息。

## <a name="video-subscription"></a>视频订阅

在一对一呼叫中，如果机器人能够接收视频，机器人将自动接收呼叫者的视频。 在Teams中，机器人必须向平台指示想要查看的参与者。 视频订阅是机器人请求接收参与者的主视频或屏幕共享内容。 当会议参与者进行对话时，机器人会修改其所需的视频订阅。 机器人根据基准扬声器集的更新或指示当前哪个参与者是屏幕共享的通知来修改视频订阅。

下一节提供有关必须安装的内容以及开发应用程序托管的媒体自动程序的要求的详细信息。

## <a name="developer-resources"></a>开发人员资源

若要开发应用程序托管的媒体自动程序，必须安装[Microsoft.Graph。Calls.Media .NET 库](https://www.nuget.org/packages/Microsoft.Graph.Communications.Calls.Media/)NuGet项目内的Visual Studio包。

应用程序托管的媒体机器人需要 .NET 或 C# Windows Server。 有关详细信息，请参阅 [应用程序托管的媒体机器人的要求和注意事项](requirements-considerations-application-hosted-media-bots.md#c-or-net-and-windows-server-for-development)。

## <a name="next-step"></a>后续步骤

> [!div class="nextstepaction"]
> [注册通话机器人](~/bots/calls-and-meetings/registering-calling-bot.md)
