---
title: 实时媒体通话和在线会议与Microsoft Teams
description: 了解构建可进行实时音频和视频呼叫和联机会议的机器人的关键概念。
ms.topic: conceptual
localization_priority: Normal
keywords: 音频流视频流 音频/视频呼叫会议实时媒体应用程序托管的媒体服务托管的媒体
ms.openlocfilehash: deedc47f67fe6848cf7f84457247d2271257e3f0
ms.sourcegitcommit: 825abed2f8784d2bab7407ba7a4455ae17bbd28f
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/26/2021
ms.locfileid: "52020153"
---
# <a name="real-time-media-calls-and-meetings-with-microsoft-teams"></a><span data-ttu-id="ac6cf-104">实时媒体通话和与会议Microsoft Teams</span><span class="sxs-lookup"><span data-stu-id="ac6cf-104">Real-time media calls and meetings with Microsoft Teams</span></span>

<span data-ttu-id="ac6cf-105">实时媒体平台允许机器人使用实时Microsoft Teams、视频和屏幕共享与通话和会议进行交互。</span><span class="sxs-lookup"><span data-stu-id="ac6cf-105">The Real-time Media Platform enables bots to interact with Microsoft Teams calls and meetings using real-time voice, video, and screen sharing.</span></span> <span data-ttu-id="ac6cf-106">这是一项高级功能，允许机器人按帧发送和接收语音和视频内容帧。</span><span class="sxs-lookup"><span data-stu-id="ac6cf-106">This is an advanced capability that allows the bot to send and receive voice and video content frame by frame.</span></span> <span data-ttu-id="ac6cf-107">机器人可以原始访问语音、视频和屏幕共享媒体流。</span><span class="sxs-lookup"><span data-stu-id="ac6cf-107">The bot has raw access to the voice, video, and screen sharing media streams.</span></span> <span data-ttu-id="ac6cf-108">还有更简单的服务托管媒体机器人，它们依赖于实时媒体平台进行所有媒体处理。</span><span class="sxs-lookup"><span data-stu-id="ac6cf-108">There are simpler service-hosted media bots that rely on the Real-time Media Platform for all media processing.</span></span> <span data-ttu-id="ac6cf-109">处理媒体本身的机器人称为应用程序托管的媒体机器人。</span><span class="sxs-lookup"><span data-stu-id="ac6cf-109">Bots that process media themselves are called application-hosted media bots.</span></span>

<span data-ttu-id="ac6cf-110">例如，在一对一呼叫中，在用户使用机器人时，机器人每秒接收 50 个音频帧，每个帧包含 20 毫秒 (毫秒) 音频。</span><span class="sxs-lookup"><span data-stu-id="ac6cf-110">For example, in a 1:1 call with a bot, as the user speaks, the bot receives 50 audio frames per second, with each frame containing 20 milliseconds (ms) of audio.</span></span> <span data-ttu-id="ac6cf-111">应用程序托管的媒体机器人可以在接收音频帧时执行实时语音识别，而不必在用户停止说话后等待录制。</span><span class="sxs-lookup"><span data-stu-id="ac6cf-111">An application-hosted media bot can perform real-time speech recognition as the audio frames are received, rather than having to wait for a recording after the user has stopped speaking.</span></span> <span data-ttu-id="ac6cf-112">机器人还可以发送和接收高分辨率视频，包括基于视频的屏幕共享内容。</span><span class="sxs-lookup"><span data-stu-id="ac6cf-112">The bot can also send and receive high-definition-resolution video, including video-based screen sharing content.</span></span>

<span data-ttu-id="ac6cf-113">该平台为机器人提供了一个与套接字类似的简单 API，用于发送和接收媒体。</span><span class="sxs-lookup"><span data-stu-id="ac6cf-113">The platform provides a simple socket-like API for the bot to send and receive media.</span></span> <span data-ttu-id="ac6cf-114">它使用编码解码器（如用于 AUDIO 和 G.722，H.264 用于视频）处理音频或视频数据包实时编码和解码。</span><span class="sxs-lookup"><span data-stu-id="ac6cf-114">It handles the real-time encoding and decoding of audio or video packets using codecs such as SILK and G.722 for audio and H.264 for video.</span></span> <span data-ttu-id="ac6cf-115">该平台还自动处理所有媒体数据包加密或解密和数据包网络传输。</span><span class="sxs-lookup"><span data-stu-id="ac6cf-115">The platform also handles all media packet encryption or decryption and packet network transmission automatically.</span></span> <span data-ttu-id="ac6cf-116">机器人只关注实际的音频或视频内容。</span><span class="sxs-lookup"><span data-stu-id="ac6cf-116">The bot is only concerned with the actual audio or video content.</span></span> <span data-ttu-id="ac6cf-117">实时媒体机器人参加一对一通话以及多个参与者的会议。</span><span class="sxs-lookup"><span data-stu-id="ac6cf-117">A real-time media bot participates in 1:1 calls as well as meetings with multiple participants.</span></span>

## <a name="media-session"></a><span data-ttu-id="ac6cf-118">媒体会话</span><span class="sxs-lookup"><span data-stu-id="ac6cf-118">Media session</span></span>

<span data-ttu-id="ac6cf-119">当实时媒体机器人应答传入呼叫或加入Teams时，它必须声明必须支持哪些形式。</span><span class="sxs-lookup"><span data-stu-id="ac6cf-119">When a real-time media bot answers an incoming call or joins a Teams meeting, it must declare what modalities it must support.</span></span> <span data-ttu-id="ac6cf-120">对于每个受支持的形式，机器人声明它可以发送和接收媒体、仅接收还是仅发送。</span><span class="sxs-lookup"><span data-stu-id="ac6cf-120">For each supported modality, the bot declares whether it can send and receive media, receive only, or send only.</span></span> <span data-ttu-id="ac6cf-121">例如，设计为处理 1：1 Teams呼叫的机器人需要发送和接收音频，但仅发送视频，因为它不需要接收呼叫者的视频。</span><span class="sxs-lookup"><span data-stu-id="ac6cf-121">For example, a bot designed to handle 1:1 Teams calls, requires to both send and receive audio, but only send video as it does not require to receive the video of the caller.</span></span> <span data-ttu-id="ac6cf-122">自动程序与呼叫者或会议之间建立的音频和视频形式Teams称为媒体会话。</span><span class="sxs-lookup"><span data-stu-id="ac6cf-122">The set of audio and video modalities established between the bot and the Teams caller or meeting is called the media session.</span></span>

<span data-ttu-id="ac6cf-123">支持两种类型的视频形式，主要基于视频和基于视频的屏幕共享。</span><span class="sxs-lookup"><span data-stu-id="ac6cf-123">Two types of video modalities are supported, main video and video-based screen sharing.</span></span> <span data-ttu-id="ac6cf-124">主视频用于从用户的摄像头传输视频。</span><span class="sxs-lookup"><span data-stu-id="ac6cf-124">The main video is used to transport the video from a user's webcam.</span></span> <span data-ttu-id="ac6cf-125">基于视频的屏幕共享允许用户将屏幕共享为视频流。</span><span class="sxs-lookup"><span data-stu-id="ac6cf-125">The video-based screen sharing allows a user to share his or her screen as a video stream.</span></span> <span data-ttu-id="ac6cf-126">该平台允许机器人发送和接收这两种视频类型。</span><span class="sxs-lookup"><span data-stu-id="ac6cf-126">The platform allows a bot to send and receive both video types.</span></span>

<span data-ttu-id="ac6cf-127">加入会议Teams，机器人可以同时接收多个主视频流，每个媒体会话最多 10 个。</span><span class="sxs-lookup"><span data-stu-id="ac6cf-127">When joined to a Teams meeting, a bot can receive multiple main video streams simultaneously up to ten per media session.</span></span> <span data-ttu-id="ac6cf-128">这允许机器人查看会议中的多个参与者。</span><span class="sxs-lookup"><span data-stu-id="ac6cf-128">This allows the bot to see more than one participant in the meeting.</span></span>

<span data-ttu-id="ac6cf-129">下一节提供有关自动程序以帧序列发送和接收媒体的详细信息。</span><span class="sxs-lookup"><span data-stu-id="ac6cf-129">The next section provides details about the bot sending and receiving media as a sequence of frames.</span></span>

## <a name="frames-and-frame-rate"></a><span data-ttu-id="ac6cf-130">帧和帧速率</span><span class="sxs-lookup"><span data-stu-id="ac6cf-130">Frames and frame rate</span></span>

<span data-ttu-id="ac6cf-131">实时媒体机器人直接与媒体会话的音频和视频形式交互。</span><span class="sxs-lookup"><span data-stu-id="ac6cf-131">A real-time media bot interacts directly with the audio and video modalities of a media session.</span></span> <span data-ttu-id="ac6cf-132">这意味着机器人将发送和接收媒体作为帧序列，其中每个帧表示一个内容单元。</span><span class="sxs-lookup"><span data-stu-id="ac6cf-132">This means the bot is sending and receiving media as a sequence of frames, where each frame represents a unit of content.</span></span> <span data-ttu-id="ac6cf-133">音频的一秒以 50 帧的序列传输，每个帧包含 20 毫秒，即语音内容的 1/50。</span><span class="sxs-lookup"><span data-stu-id="ac6cf-133">One second of audio is transmitted as a sequence of 50 frames, with each frame containing 20 ms that is 1/50th of a second of speech content.</span></span> <span data-ttu-id="ac6cf-134">视频的一秒作为 30 个静止图像序列进行传输，每个图像应仅查看 33.3 毫秒，即显示下一个视频帧前 1/30 秒。</span><span class="sxs-lookup"><span data-stu-id="ac6cf-134">One second of video is transmitted as a sequence of 30 still images, each intended to be viewed for just 33.3 ms that is 1/30th of a second before the next video frame is displayed.</span></span> <span data-ttu-id="ac6cf-135">每秒传输或呈现的帧数称为帧速率。</span><span class="sxs-lookup"><span data-stu-id="ac6cf-135">The number of frames transmitted or rendered per second is called the frame rate.</span></span>

<span data-ttu-id="ac6cf-136">下一节提供有关实时媒体呼叫和会议中使用的音频和视频格式的详细信息。</span><span class="sxs-lookup"><span data-stu-id="ac6cf-136">The next section provides details about the audio and video format used in real-time media calls and meetings.</span></span>

## <a name="audio-and-video-format"></a><span data-ttu-id="ac6cf-137">音频和视频格式</span><span class="sxs-lookup"><span data-stu-id="ac6cf-137">Audio and video format</span></span>

<span data-ttu-id="ac6cf-138">在音频格式中，音频的每秒钟表示为 16，000 个样本，每个样本包含 16 位数据。</span><span class="sxs-lookup"><span data-stu-id="ac6cf-138">In audio format, each second of audio is represented as 16,000 samples, with each sample containing 16-bits of data.</span></span> <span data-ttu-id="ac6cf-139">20 毫秒的音频帧包含 320 个样本，即 640 字节的数据。</span><span class="sxs-lookup"><span data-stu-id="ac6cf-139">A 20 ms audio frame contains 320 samples that is 640 bytes of data.</span></span>

<span data-ttu-id="ac6cf-140">在视频格式中，支持多种格式。</span><span class="sxs-lookup"><span data-stu-id="ac6cf-140">In video format, several formats are supported.</span></span> <span data-ttu-id="ac6cf-141">视频格式的两个关键属性是帧大小和颜色格式。</span><span class="sxs-lookup"><span data-stu-id="ac6cf-141">Two key properties of a video format are its frame size and color format.</span></span> <span data-ttu-id="ac6cf-142">受支持的帧大小包括 640x360（即 360 像素、1280x720 为 720 像素）和 1920x1080（即 1080 像素）。</span><span class="sxs-lookup"><span data-stu-id="ac6cf-142">Supported frame sizes include 640x360 that is 360 pixels, 1280x720 that is 720 pixels, and 1920x1080 that is 1080 pixels.</span></span> <span data-ttu-id="ac6cf-143">支持的颜色格式包括每像素 12 位的 NV12 和每像素 24 位的 RGB24。</span><span class="sxs-lookup"><span data-stu-id="ac6cf-143">Supported color formats include NV12 that is 12 bits per pixel and RGB24 that is 24 bits per pixel.</span></span>

<span data-ttu-id="ac6cf-144">720p 视频帧包含 921，600 像素，即 1280 倍 720 像素。</span><span class="sxs-lookup"><span data-stu-id="ac6cf-144">A 720p video frame contains 921,600 pixels that is 1280 times 720.</span></span> <span data-ttu-id="ac6cf-145">在 RGB24 颜色格式中，每个像素表示为 3 个字节，即 24 位，由每个红色、绿色和蓝色分量的一个字节组成。</span><span class="sxs-lookup"><span data-stu-id="ac6cf-145">In the RGB24 color format, each pixel is represented as 3 bytes that is 24-bits comprised of one byte each of red, green, and blue color components.</span></span> <span data-ttu-id="ac6cf-146">因此，单个 720p RGB24 视频帧需要 2，764，800 字节的数据，即每个像素 921，600 像素 x 3 字节。</span><span class="sxs-lookup"><span data-stu-id="ac6cf-146">Therefore, a single 720p RGB24 video frame requires 2,764,800 bytes of data that is 921,600 pixels times 3 bytes per pixel.</span></span> <span data-ttu-id="ac6cf-147">以 30 fps 的帧速率发送 720p RGB24 视频帧意味着每秒处理大约 80 MB 的内容，在网络传输之前，H.264 视频编解码器会显著压缩这些内容。</span><span class="sxs-lookup"><span data-stu-id="ac6cf-147">At a frame rate of 30 fps, sending 720p RGB24 video frames means processing approximately 80 megabytes per second of content, which is substantially compressed by the H.264 video codec before network transmission.</span></span>

<span data-ttu-id="ac6cf-148">平台的高级功能允许机器人以编码的 H.264 帧发送或接收视频。</span><span class="sxs-lookup"><span data-stu-id="ac6cf-148">An advanced capability of the platform allows a bot to send or receive video as encoded H.264 frames.</span></span> <span data-ttu-id="ac6cf-149">这支持提供其自己的 H.264 编码器或解码器的机器人，或者不需要解码为原始 RGB24 或 NV12 位图的视频流。</span><span class="sxs-lookup"><span data-stu-id="ac6cf-149">This supports bots which provide their own H.264 encoder or decoder, or do not require the video stream decoded into raw RGB24 or NV12 bitmaps.</span></span>

<span data-ttu-id="ac6cf-150">下一节详细介绍哪些会议参与者在说话，哪些与会者是活动且惯用的发言人。</span><span class="sxs-lookup"><span data-stu-id="ac6cf-150">The next section provides details about which meeting participants are speaking that is which are active and dominant speakers.</span></span>

## <a name="active-and-dominant-speakers"></a><span data-ttu-id="ac6cf-151">主动和基准扬声器</span><span class="sxs-lookup"><span data-stu-id="ac6cf-151">Active and dominant speakers</span></span>

<span data-ttu-id="ac6cf-152">加入由多个Teams加入会议时，机器人可以识别当前正在说话的会议参与者。</span><span class="sxs-lookup"><span data-stu-id="ac6cf-152">When joined to a Teams meeting consisting of multiple participants, a bot can identify which meeting participants are currently speaking.</span></span> <span data-ttu-id="ac6cf-153">活动扬声器确定在每个收到的音频帧中听到的参与者。</span><span class="sxs-lookup"><span data-stu-id="ac6cf-153">Active speakers identify which participants are being heard in each received audio frame.</span></span> <span data-ttu-id="ac6cf-154">基准扬声器确定哪些参与者当前在组对话中最活跃或最惯用，即使在每个音频帧中都未听到他们的声音。</span><span class="sxs-lookup"><span data-stu-id="ac6cf-154">Dominant speakers identify which participants are currently most active or dominant in the group conversation, even though their voice is not heard in every audio frame.</span></span> <span data-ttu-id="ac6cf-155">当不同的参与者轮次说话时，一组惯用说话的人可能会更改。</span><span class="sxs-lookup"><span data-stu-id="ac6cf-155">The set of dominant speakers can change as different participants take turns speaking.</span></span>

<span data-ttu-id="ac6cf-156">下一节提供有关机器人提出的视频订阅请求的详细信息。</span><span class="sxs-lookup"><span data-stu-id="ac6cf-156">The next section provides details about video subscription requests made by a bot.</span></span>

## <a name="video-subscription"></a><span data-ttu-id="ac6cf-157">视频订阅</span><span class="sxs-lookup"><span data-stu-id="ac6cf-157">Video subscription</span></span>

<span data-ttu-id="ac6cf-158">在一对一呼叫中，如果机器人能够接收视频，机器人将自动接收呼叫者的视频。</span><span class="sxs-lookup"><span data-stu-id="ac6cf-158">In a 1:1 call, the bot automatically receives the video of the caller if the bot is enabled to receive the video.</span></span> <span data-ttu-id="ac6cf-159">在Teams中，机器人必须向平台指示想要查看的参与者。</span><span class="sxs-lookup"><span data-stu-id="ac6cf-159">In a Teams meeting, the bot must indicate to the platform which participants it wants to see.</span></span> <span data-ttu-id="ac6cf-160">视频订阅是机器人请求接收参与者的主视频或屏幕共享内容。</span><span class="sxs-lookup"><span data-stu-id="ac6cf-160">A video subscription is a request by the bot to receive a participant’s main video or screen-sharing content.</span></span> <span data-ttu-id="ac6cf-161">当会议参与者进行对话时，机器人会基于基准扬声器集的更新或指示当前哪个参与者是屏幕共享的通知修改所需的视频订阅。</span><span class="sxs-lookup"><span data-stu-id="ac6cf-161">As the participants in the meeting conduct their conversation, the bot modifies its desired video subscriptions based on updates of the dominant speaker set or notifications indicating which participant is currently screen sharing.</span></span>

<span data-ttu-id="ac6cf-162">下一节提供有关必须安装的内容以及开发应用程序托管的媒体自动程序的要求的详细信息。</span><span class="sxs-lookup"><span data-stu-id="ac6cf-162">The next section provides details about what you must install and the requirements to develop an application-hosted media bot.</span></span>

## <a name="developer-resources"></a><span data-ttu-id="ac6cf-163">开发人员资源</span><span class="sxs-lookup"><span data-stu-id="ac6cf-163">Developer resources</span></span>

<span data-ttu-id="ac6cf-164">若要开发应用程序托管的媒体自动程序，必须安装[Microsoft.Graph。Calls.Media .NET 库](https://www.nuget.org/packages/Microsoft.Graph.Communications.Calls.Media/)NuGet项目内的Visual Studio包。</span><span class="sxs-lookup"><span data-stu-id="ac6cf-164">To develop an application-hosted media bot, you must install the [Microsoft.Graph.Calls.Media .NET library](https://www.nuget.org/packages/Microsoft.Graph.Communications.Calls.Media/) NuGet package within your Visual Studio project.</span></span>

<span data-ttu-id="ac6cf-165">应用程序托管的媒体机器人需要 .NET 或 C# Windows Server。</span><span class="sxs-lookup"><span data-stu-id="ac6cf-165">Application-hosted media bots require .NET or C# and Windows Server.</span></span> <span data-ttu-id="ac6cf-166">有关详细信息，请参阅 [应用程序托管的媒体机器人的要求和注意事项](requirements-considerations-application-hosted-media-bots.md#c-or-net-and-windows-server-for-development)。</span><span class="sxs-lookup"><span data-stu-id="ac6cf-166">For more information, see [requirements and considerations for application-hosted media bots](requirements-considerations-application-hosted-media-bots.md#c-or-net-and-windows-server-for-development).</span></span>

## <a name="next-step"></a><span data-ttu-id="ac6cf-167">后续步骤</span><span class="sxs-lookup"><span data-stu-id="ac6cf-167">Next step</span></span>

> [!div class="nextstepaction"]
> [<span data-ttu-id="ac6cf-168">注册通话机器人</span><span class="sxs-lookup"><span data-stu-id="ac6cf-168">Register a calling bot</span></span>](~/bots/calls-and-meetings/registering-calling-bot.md)
